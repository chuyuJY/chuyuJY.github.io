<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>çˆ¬è™« - Chuyu&#39;s Blog</title><meta name="Description" content="ğŸ˜"><meta property="og:title" content="çˆ¬è™«" />
<meta property="og:description" content="çˆ¬è™« ä¸€ã€æ¦‚è¿° 1.1 requestså…¥é—¨ å®‰è£…requests 1 conda install requests 1 2 3 # windows éœ€è¦åŠ ä¸Š encoding=&#34;utf-8&#34;, macæ˜¯é»˜è®¤çš„ with open(&#34;mybaidu.html&#34;, mode=&#34;w&#34;, encoding=&#34;utf-8&#34;) as f: f.write(resp.read().decode(&#34;utf-8&#34;)) åœ¨åœ°å€æ ä¸­è¾“å…¥æœç´¢çš„å†…å®¹ï¼Œè¿™ç§" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.seucy.me/%E7%88%AC%E8%99%AB/" /><meta property="og:image" content="https://blog.seucy.me/images/avatar.jpg"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-07-18T20:13:28+08:00" />
<meta property="article:modified_time" content="2023-07-18T20:13:28+08:00" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://blog.seucy.me/images/avatar.jpg"/>

<meta name="twitter:title" content="çˆ¬è™«"/>
<meta name="twitter:description" content="çˆ¬è™« ä¸€ã€æ¦‚è¿° 1.1 requestså…¥é—¨ å®‰è£…requests 1 conda install requests 1 2 3 # windows éœ€è¦åŠ ä¸Š encoding=&#34;utf-8&#34;, macæ˜¯é»˜è®¤çš„ with open(&#34;mybaidu.html&#34;, mode=&#34;w&#34;, encoding=&#34;utf-8&#34;) as f: f.write(resp.read().decode(&#34;utf-8&#34;)) åœ¨åœ°å€æ ä¸­è¾“å…¥æœç´¢çš„å†…å®¹ï¼Œè¿™ç§"/>
<meta name="application-name" content="Chuyu&#39;s Blog">
<meta name="apple-mobile-web-app-title" content="Chuyu&#39;s Blog"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="/images/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://blog.seucy.me/%E7%88%AC%E8%99%AB/" /><link rel="next" href="https://blog.seucy.me/go%E5%9F%BA%E7%A1%80%E6%93%8D%E4%BD%9C/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "çˆ¬è™«",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/blog.seucy.me\/%E7%88%AC%E8%99%AB\/"
        },"genre": "posts","keywords": "è®¡ç®—æœºåŸºç¡€, çˆ¬è™«, python","wordcount":  11747 ,
        "url": "https:\/\/blog.seucy.me\/%E7%88%AC%E8%99%AB\/","datePublished": "2022-07-18T20:13:28+08:00","dateModified": "2023-07-18T20:13:28+08:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "Chuyu"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Chuyu&#39;s Blog">á“« (Â°âŒ‘Â°) Çƒ</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> å½’æ¡£ </a><a class="menu-item" href="/tags/"> æ ‡ç­¾ </a><a class="menu-item" href="/categories/"> åˆ†ç±» </a><a class="menu-item" href="/about/"> å…³äº </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Chuyu&#39;s Blog">á“« (Â°âŒ‘Â°) Çƒ</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title="">å½’æ¡£</a><a class="menu-item" href="/tags/" title="">æ ‡ç­¾</a><a class="menu-item" href="/categories/" title="">åˆ†ç±»</a><a class="menu-item" href="/about/" title="">å…³äº</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">çˆ¬è™«</h1><h2 class="single-subtitle">çˆ¬è™«</h2><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Chuyu</a></span>&nbsp;<span class="post-category">included in <a href="/categories/%E9%80%9A%E7%94%A8/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>é€šç”¨</a>&nbsp;<a href="/categories/python/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>python</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2022-07-18">2022-07-18</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;11747 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;24 minutes&nbsp;<span id="/%E7%88%AC%E8%99%AB/" class="leancloud_visitors" data-flag-title="çˆ¬è™«">
                        <i class="far fa-eye fa-fw" aria-hidden="true"></i>&nbsp;<span class=leancloud-visitors-count></span>&nbsp;views
                    </span>&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#ä¸€æ¦‚è¿°">ä¸€ã€æ¦‚è¿°</a>
      <ul>
        <li><a href="#11-requestså…¥é—¨">1.1 requestså…¥é—¨</a></li>
      </ul>
    </li>
    <li><a href="#äºŒæ•°æ®è§£æ">äºŒã€æ•°æ®è§£æ</a>
      <ul>
        <li><a href="#21-reè§£æ">2.1 Reè§£æ</a>
          <ul>
            <li><a href="#211-re-è±†ç“£top250">2.1.1 Re-è±†ç“£Top250</a></li>
          </ul>
        </li>
        <li><a href="#22-bs4è§£æ">2.2 bs4è§£æ</a></li>
        <li><a href="#23-xpathè§£æ">2.3 Xpathè§£æ</a></li>
      </ul>
    </li>
    <li><a href="#ä¸‰requestè¿›é˜¶">ä¸‰ã€requestè¿›é˜¶</a>
      <ul>
        <li><a href="#31-æ¨¡æ‹Ÿç™»å½•-cookie">3.1 æ¨¡æ‹Ÿç™»å½•-cookie</a></li>
        <li><a href="#32-é˜²ç›—é“¾">3.2 é˜²ç›—é“¾</a></li>
        <li><a href="#33-ä»£ç†">3.3 ä»£ç†</a></li>
        <li><a href="#34-ç½‘æ˜“äº‘è¯„è®º">3.4 ç½‘æ˜“äº‘è¯„è®º</a></li>
      </ul>
    </li>
    <li><a href="#å››åŠ é€Ÿ">å››ã€åŠ é€Ÿ</a>
      <ul>
        <li><a href="#41-å¤šçº¿ç¨‹">4.1 å¤šçº¿ç¨‹</a></li>
        <li><a href="#42-å¤šè¿›ç¨‹">4.2 å¤šè¿›ç¨‹</a></li>
        <li><a href="#43-çº¿ç¨‹æ± è¿›ç¨‹æ± ">4.3 çº¿ç¨‹æ± \è¿›ç¨‹æ± </a></li>
        <li><a href="#44-åç¨‹">4.4 åç¨‹</a></li>
        <li><a href="#45-aiohttpæ¨¡å—åº”ç”¨">4.5 aiohttpæ¨¡å—åº”ç”¨</a></li>
        <li><a href="#46-æŠ“å–å°è¯´">4.6 æŠ“å–å°è¯´</a></li>
        <li><a href="#47-è§†é¢‘æŠ“å–">4.7 è§†é¢‘æŠ“å–</a>
          <ul>
            <li><a href="#471-ç®€å•éš¾åº¦">4.7.1 ç®€å•éš¾åº¦</a></li>
            <li><a href="#472-å¤æ‚91">4.7.2 å¤æ‚91</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#äº”selenium">äº”ã€selenium</a>
      <ul>
        <li><a href="#51-æ¦‚è¿°">5.1 æ¦‚è¿°</a></li>
        <li><a href="#52-çª—å£åˆ‡æ¢">5.2 çª—å£åˆ‡æ¢</a></li>
        <li><a href="#53-æ— å¤´æµè§ˆå™¨">5.3 æ— å¤´æµè§ˆå™¨</a></li>
        <li><a href="#54-éªŒè¯ç è¯†åˆ«">5.4 éªŒè¯ç è¯†åˆ«</a></li>
        <li><a href="#55-é˜²æ­¢è‡ªåŠ¨åŒ–è¢«å±è”½">5.5 é˜²æ­¢è‡ªåŠ¨åŒ–è¢«å±è”½</a></li>
      </ul>
    </li>
    <li><a href="#å…­jsé€†å‘">å…­ã€Jsé€†å‘</a>
      <ul>
        <li><a href="#61-æ–­ç‚¹">6.1 æ–­ç‚¹</a></li>
      </ul>
    </li>
    <li><a href="#ä¸ƒscrapyæ¡†æ¶">ä¸ƒã€Scrapyæ¡†æ¶</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h1 id="çˆ¬è™«">çˆ¬è™«</h1>
<h2 id="ä¸€æ¦‚è¿°">ä¸€ã€æ¦‚è¿°</h2>
<h3 id="11-requestså…¥é—¨">1.1 requestså…¥é—¨</h3>
<ul>
<li>
<p>å®‰è£…requests</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">conda</span> <span class="n">install</span> <span class="n">requests</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># windows éœ€è¦åŠ ä¸Š encoding=&#34;utf-8&#34;, macæ˜¯é»˜è®¤çš„</span>
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;mybaidu.html&#34;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&#34;w&#34;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&#34;utf-8&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&#34;utf-8&#34;</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<ol>
<li>
<p>åœ¨åœ°å€æ ä¸­è¾“å…¥æœç´¢çš„å†…å®¹ï¼Œè¿™ç§æ–¹å¼éƒ½æ˜¯get</p>
<p>è‹¥è¢«å‘ç°æ˜¯è‡ªåŠ¨è®¾å¤‡å‘å‡ºçš„è¯·æ±‚è€Œè¢«æ‹’ç»ï¼Œå¯ä»¥é€šè¿‡æ·»åŠ agentï¼Œå¦‚ä¸‹å›¾ä¸­ï¼š</p>
</li>
</ol>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220218101506003.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220218101506003.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220218101506003.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220218101506003.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220218101506003.png"
        title="image-20220218101506003" /></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æ·»åŠ agent é˜²æ­¢è¢«è¯†åˆ«ä¸ºè‡ªåŠ¨åŒ–è¯·æ±‚</span>
</span></span><span class="line"><span class="cl"><span class="n">dic</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;user-agent&#34;</span><span class="p">:</span> <span class="s2">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">dic</span><span class="p">)</span>   <span class="c1"># å¤„ç†äº†ä¸€ä¸ªå°åçˆ¬</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ol start="2">
<li>å®ç°ç¿»è¯‘åŠŸèƒ½</li>
</ol>
<p>å¯»æ‰¾ä¸‹å›¾ä¸­çš„è¯·æ±‚ï¼š</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220218105817002.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220218105817002.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220218105817002.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220218105817002.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220218105817002.png"
        title="image-20220218105817002" /></p>
<p>å…¶è¯·æ±‚æ–¹å¼ä¸ºpostæ–¹å¼ï¼Œä»è½½è·ä¸­æŸ¥çœ‹æäº¤çš„æ•°æ®ï¼Œå¹¶æ„é€ jsonè¿›è¡Œæäº¤ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;https://fanyi.sogou.com/reventondc/suggV3&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">s</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&#34;è¯·è¾“å…¥ä½ è¦æŸ¥è¯¢çš„å•è¯:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">dat</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;from&#34;</span><span class="p">:</span> <span class="s2">&#34;auto&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;to&#34;</span><span class="p">:</span> <span class="s2">&#34;zh-CHS&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;client&#34;</span><span class="p">:</span> <span class="s2">&#34;web&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;text&#34;</span><span class="p">:</span> <span class="n">s</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;uuid&#34;</span><span class="p">:</span> <span class="s2">&#34;da793e6d-1a41-4448-8df5-ae35fc402c3a&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;pid&#34;</span><span class="p">:</span> <span class="s2">&#34;sogou-dict-vr&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;addSugg&#34;</span><span class="p">:</span> <span class="s2">&#34;on&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">dat</span><span class="p">)</span>     <span class="c1"># å°†æœåŠ¡å™¨è¿”å›çš„å†…å®¹ç›´æ¥å¤„ç†æˆjson()  ==&gt; dictæ ¼å¼</span>
</span></span><span class="line"><span class="cl"><span class="n">dic</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="s1">&#39;sugg&#39;</span><span class="p">])</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ol start="3">
<li>çˆ¬å–è±†ç“£ç”µå½±æ¦œå•</li>
</ol>
<p>æŸ¥çœ‹è½½è·ï¼Œå‘ç°æ¯æ¬¡æ–°åˆ·æ–°å†…å®¹ï¼Œåªæœ‰start+20ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡æ”¹å˜è¯·æ±‚ä¸­çš„startæ•°æ®æ¥çˆ¬å–æ‰€æœ‰æ¦œå•ä¿¡æ¯ã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220218112901922.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220218112901922.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220218112901922.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220218112901922.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220218112901922.png"
        title="image-20220218112901922" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220218112917801.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220218112917801.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220218112917801.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220218112917801.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220218112917801.png"
        title="image-20220218112917801" /></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;https://movie.douban.com/j/chart/top_list&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">info</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">header</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;User-Agent&#34;</span><span class="p">:</span> <span class="s2">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">20</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">param</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;type&#34;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;interval_id&#39;</span><span class="p">:</span> <span class="s2">&#34;100:90&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;start&#34;</span><span class="p">:</span> <span class="n">count</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;limit&#34;</span><span class="p">:</span> <span class="mi">20</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">param</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">header</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">info</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="n">resp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>  <span class="c1"># å…³æ‰resp</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="äºŒæ•°æ®è§£æ">äºŒã€æ•°æ®è§£æ</h2>
<p>æä¾›ä¸‰ç§è§£ææ–¹å¼ï¼š</p>
<ul>
<li>reè§£æ</li>
<li>bs4è§£æï¼ˆä½¿ç”¨æ–¹ä¾¿ï¼Œä½†è§£æé€Ÿåº¦è¾ƒæ…¢ï¼‰</li>
<li>xpathè§£æ</li>
</ul>
<p>æŒæ¡ä¹‹åï¼Œå†è€ƒè™‘æ€§èƒ½é—®é¢˜ã€‚</p>
<h3 id="21-reè§£æ">2.1 Reè§£æ</h3>
<p>Reï¼Œæ­£åˆ™è¡¨è¾¾å¼ã€‚</p>
<p>è¯­æ³•ï¼šä½¿ç”¨å…ƒå­—ç¬¦è¿›è¡Œæ’åˆ—ç»„åˆç”¨æ¥åŒ¹é…å­—ç¬¦ä¸²ï¼Œåœ¨çº¿æµ‹è¯•æ­£åˆ™è¡¨è¾¾å¼ï¼šhttps://tool.oschina.net/regex</p>
<p>å…ƒå­—ç¬¦ï¼šå…·æœ‰å›ºå®šå«ä¹‰çš„ç‰¹æ®Šç¬¦å·</p>
<p>å¸¸ç”¨å…ƒå­—ç¬¦ï¼šhttps://cloud.tencent.com/developer/article/1337734</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">.</span>		<span class="n">åŒ¹é…é™¤æ¢è¡Œç¬¦ä»¥å¤–çš„ä»»æ„å­—ç¬¦</span>
</span></span><span class="line"><span class="cl">\<span class="n">w</span>		<span class="n">åŒ¹é…å­—æ¯</span><span class="err">ã€</span><span class="n">æ•°å­—</span><span class="err">ã€</span><span class="n">ä¸‹åˆ’çº¿</span>
</span></span><span class="line"><span class="cl">\<span class="n">s</span>		<span class="n">åŒ¹é…ä»»æ„çš„ç©ºç™½ç¬¦</span>
</span></span><span class="line"><span class="cl">\<span class="n">d</span>		<span class="n">åŒ¹é…æ•°å­—</span>
</span></span><span class="line"><span class="cl">\<span class="n">n</span>		<span class="n">åŒ¹é…ä¸€ä¸ªæ¢è¡Œç¬¦</span>
</span></span><span class="line"><span class="cl">\<span class="n">t</span>		<span class="n">åŒ¹é…ä¸€ä¸ªåˆ¶è¡¨ç¬¦</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">^</span>		<span class="n">åŒ¹é…å­—ç¬¦ä¸²çš„å¼€å§‹</span>
</span></span><span class="line"><span class="cl"><span class="err">$</span>		<span class="n">åŒ¹é…å­—ç¬¦ä¸²çš„ç»“å°¾</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">\<span class="n">W</span>		<span class="n">åŒ¹é…éå­—æ¯</span><span class="err">ã€</span><span class="n">éæ•°å­—</span><span class="err">ã€</span><span class="n">éä¸‹åˆ’çº¿</span>
</span></span><span class="line"><span class="cl">\<span class="n">D</span>		<span class="n">åŒ¹é…éæ•°å­—</span>
</span></span><span class="line"><span class="cl">\<span class="n">S</span>		<span class="n">åŒ¹é…éç©ºç™½ç¬¦</span>
</span></span><span class="line"><span class="cl"><span class="n">a</span><span class="o">|</span><span class="n">b</span>		<span class="n">åŒ¹é…å­—ç¬¦aæˆ–å­—ç¬¦b</span>
</span></span><span class="line"><span class="cl"><span class="p">()</span>		<span class="n">åŒ¹é…æ‹¬å·å†…çš„è¡¨è¾¾å¼</span><span class="err">ï¼Œ</span><span class="n">ä¹Ÿè¡¨ç¤ºä¸€ä¸ªç»„</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="o">...</span><span class="p">]</span>	<span class="n">åŒ¹é…å­—ç¬¦ç»„ä¸­çš„å­—ç¬¦</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="o">^...</span><span class="p">]</span>	<span class="n">åŒ¹é…é™¤äº†å­—ç¬¦ç»„ä¸­å­—ç¬¦çš„æ‰€æœ‰å­—ç¬¦</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>é‡è¯ï¼šæ§åˆ¶å‰é¢çš„å…ƒå­—ç¬¦å‡ºç°çš„æ¬¡æ•°ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">*</span>		<span class="n">é‡å¤é›¶æ¬¡æˆ–æ›´å¤šæ¬¡</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>		<span class="n">é‡å¤ä¸€æ¬¡æˆ–æ›´å¤šæ¬¡</span>
</span></span><span class="line"><span class="cl"><span class="err">?</span>		<span class="n">é‡å¤é›¶æ¬¡æˆ–ä¸å‡ºç°</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="n">n</span><span class="p">}</span>		<span class="n">é‡å¤næ¬¡</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="n">n</span><span class="p">,}</span>	<span class="n">é‡å¤næ¬¡æˆ–æ›´å¤šæ¬¡</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">}</span>	<span class="n">é‡å¤nåˆ°mæ¬¡</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è´ªå©ªåŒ¹é…å’Œæƒ°æ€§åŒ¹é…</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">.*</span>		<span class="n">è´ªå©ªåŒ¹é…</span>							 <span class="p">(</span><span class="n">ç©å„¿åƒé¸¡æ¸¸æˆ</span><span class="err">ï¼Œ</span><span class="n">ç©ä»€ä¹ˆæ¸¸æˆ</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">.*</span><span class="err">?</span>		<span class="n">æ‰¾æœ€çŸ­çš„</span><span class="err">ï¼Œ?</span><span class="n">ä½¿å°½å¯èƒ½å°‘çš„</span><span class="o">*</span><span class="err">ï¼Œ</span><span class="n">å°½å¯èƒ½å°‘çš„åŒ¹é…</span>  <span class="p">(</span><span class="n">ç©å„¿åƒé¸¡æ¸¸æˆ</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¾‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&#34;jay&#34;</span><span class="o">&gt;</span><span class="n">å‘¨æ°ä¼¦</span><span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&#34;jj&#34;</span><span class="o">&gt;</span><span class="n">æ—ä¿Šæ°</span><span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="n">ä½¿ç”¨</span><span class="err">ï¼š</span><span class="o">&lt;.*</span><span class="err">?</span><span class="s2">&#34;.*?&#34;</span><span class="o">&gt;.*</span><span class="err">?</span><span class="o">&gt;</span> <span class="n">æˆ–</span> <span class="o">.*</span><span class="err">?</span><span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="n">ç»“æœ</span><span class="err">ï¼š</span><span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&#34;jay&#34;</span><span class="o">&gt;</span><span class="n">å‘¨æ°ä¼¦</span><span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	 <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&#34;jj&#34;</span><span class="o">&gt;</span><span class="n">æ—ä¿Šæ°</span><span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æˆ‘ä»¬çˆ¬è™«ç”¨çš„æœ€å¤šçš„å°±æ˜¯==æƒ°æ€§åŒ¹é…==</p>
<p>==é‡ç‚¹==ï¼š</p>
<p>ä»¥ä¸‹å‡ ä¸ªåŠŸèƒ½å°±è¶³å¤Ÿä½¿ç”¨ï¼š</p>
<table>
<thead>
<tr>
<th style="text-align:left">finditer</th>
<th>å’ŒfindallåŠŸèƒ½ç›¸ä¼¼ï¼ˆæŸ¥æ‰¾æ‰€æœ‰ï¼‰ï¼Œä½†æ˜¯è¿”å›è¿­ä»£å™¨ï¼Œæ•ˆç‡é«˜</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">findall</td>
<td>æŸ¥æ‰¾æ‰€æœ‰ï¼Œè¿”å›list</td>
</tr>
<tr>
<td style="text-align:left">search</td>
<td>èƒ½å¤Ÿè¿›è¡Œå…¨æ–‡åŒ¹é…ï¼Œä½†æ£€ç´¢åˆ°ç¬¬ä¸€ä¸ªå°±åœæ­¢å¹¶è¿”å›</td>
</tr>
<tr>
<td style="text-align:left">match</td>
<td>åªèƒ½ä»å­—ç¬¦ä¸²çš„å¤´éƒ¨å¼€å§‹åŒ¹é…</td>
</tr>
</tbody>
</table>
<p>é¢„åŠ è½½æ­£åˆ™ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">obj</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;æ­£åˆ™&#34;</span><span class="p">)</span> 
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä»è¿­ä»£å™¨ä¸­æ‹¿åˆ°å†…å®¹éœ€è¦ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">è¿”å›çš„è¿­ä»£å™¨å¯¹è±¡</span><span class="o">.</span><span class="n">group</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æå–æœ‰ç”¨çš„æ•°æ®ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">(</span><span class="err">?</span><span class="n">P</span><span class="o">&lt;</span><span class="n">group</span><span class="o">&gt;</span><span class="n">æ­£åˆ™</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æœ€é‡è¦*** finditer: åŒ¹é…å­—ç¬¦ä¸²ä¸­æ‰€æœ‰çš„å†…å®¹[è¿”å›çš„æ˜¯è¿­ä»£å™¨]</span>
</span></span><span class="line"><span class="cl"><span class="n">it</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;\d+&#34;</span><span class="p">,</span> <span class="s2">&#34;æˆ‘çš„ç”µè¯å·æ˜¯:10086, æˆ‘å¥³æœ‹å‹çš„ç”µè¯æ˜¯:10010&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ä»è¿­ä»£å™¨ä¸­æ‹¿åˆ°å†…å®¹éœ€è¦ .group()</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">it</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">group</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># é¢„åŠ è½½æ­£åˆ™  å¯ä»¥æé«˜æ•ˆç‡</span>
</span></span><span class="line"><span class="cl"><span class="n">obj</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;\d+&#34;</span><span class="p">)</span>  <span class="c1"># å¯ä»¥å¤šæ¬¡ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="n">ret</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="s2">&#34;æˆ‘çš„ç”µè¯å·æ˜¯:10086, æˆ‘å¥³æœ‹å‹çš„ç”µè¯æ˜¯:10010&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ret</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">group</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># éå¸¸éå¸¸é‡è¦çš„ç‚¹ ********</span>
</span></span><span class="line"><span class="cl"><span class="n">s</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">&lt;div class=&#39;jay&#39;&gt;&lt;span id=&#39;1&#39;&gt;éƒ­éº’éºŸ&lt;/span&gt;&lt;/div&gt;
</span></span></span><span class="line"><span class="cl"><span class="s2">&lt;div class=&#39;jj&#39;&gt;&lt;span id=&#39;2&#39;&gt;å®‹é“&lt;/span&gt;&lt;/div&gt;
</span></span></span><span class="line"><span class="cl"><span class="s2">&lt;div class=&#39;jolin&#39;&gt;&lt;span id=&#39;3&#39;&gt;å¤§èªæ˜&lt;/span&gt;&lt;/div&gt;
</span></span></span><span class="line"><span class="cl"><span class="s2">&lt;div class=&#39;sylar&#39;&gt;&lt;span id=&#39;4&#39;&gt;èŒƒæ€å“²&lt;/span&gt;&lt;/div&gt;
</span></span></span><span class="line"><span class="cl"><span class="s2">&lt;div class=&#39;tory&#39;&gt;&lt;span id=&#39;5&#39;&gt;èƒ¡è¯´å…«é“&lt;/span&gt;&lt;/div&gt;
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">obj</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;&lt;div class=&#39;.*?&#39;&gt;&lt;span id=&#39;\d+&#39;&gt;.*?&lt;/span&gt;&lt;/div&gt;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ret</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ret</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">group</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="c1"># æå–æœ‰ç”¨çš„æ•°æ® (?P&lt;group&gt;æ­£åˆ™)</span>
</span></span><span class="line"><span class="cl"><span class="n">obj</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;&lt;div class=&#39;(?P&lt;class&gt;.*?)&#39;&gt;&lt;span id=&#39;(?P&lt;id&gt;\d+)&#39;&gt;(?P&lt;name&gt;.*?)&lt;/span&gt;&lt;/div&gt;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ret</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ret</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;class:&#34;</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&#34;class&#34;</span><span class="p">),</span> <span class="s2">&#34;id:&#34;</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&#34;id&#34;</span><span class="p">),</span> <span class="s2">&#34;name:&#34;</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&#34;name&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># findall: åŒ¹é…å­—ç¬¦ä¸²ä¸­æ‰€æœ‰çš„ç¬¦åˆæ­£åˆ™çš„å†…å®¹[è¿”å›çš„æ˜¯æ•°ç»„]  (ä¸ç»å¸¸ç”¨ æ•°ç»„æ•ˆç‡ä½)</span>
</span></span><span class="line"><span class="cl"><span class="n">lst</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;\d+&#34;</span><span class="p">,</span> <span class="s2">&#34;æˆ‘çš„ç”µè¯å·æ˜¯:10086, æˆ‘å¥³æœ‹å‹çš„ç”µè¯æ˜¯:10010&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># search: å…¨æ–‡è¿›è¡ŒåŒ¹é…ï¼Œæ‰¾åˆ°ä¸€ä¸ªç»“æœå°±è¿”å›ï¼Œä¸ä¼šå…¨éƒ½æ‰¾åˆ°ã€‚</span>
</span></span><span class="line"><span class="cl"><span class="c1"># è¿”å›çš„ç»“æœæ˜¯matchå¯¹è±¡, æ‹¿æ•°æ®éœ€è¦ .group()</span>
</span></span><span class="line"><span class="cl"><span class="n">s</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;\d+&#34;</span><span class="p">,</span> <span class="s2">&#34;æˆ‘çš„ç”µè¯å·æ˜¯:10086, æˆ‘å¥³æœ‹å‹çš„ç”µè¯æ˜¯:10010&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">group</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># match: ä»å¤´å¼€å§‹åŒ¹é…ï¼Œ</span>
</span></span><span class="line"><span class="cl"><span class="n">s</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="k">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;\d+&#34;</span><span class="p">,</span> <span class="s2">&#34;10086, æˆ‘å¥³æœ‹å‹çš„ç”µè¯æ˜¯:10010&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">group</span><span class="p">())</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="211-re-è±†ç“£top250">2.1.1 Re-è±†ç“£Top250</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æ‹¿åˆ°é¡µé¢æºä»£ç â€”â€”requests</span>
</span></span><span class="line"><span class="cl"><span class="c1"># é€šè¿‡reæ¥æå–æƒ³è¦çš„æœ‰æ•ˆä¿¡æ¯â€”â€”re</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="c1"># å­˜å‚¨æ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">csv</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">num</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;User-Agent&#34;</span><span class="p">:</span> <span class="s2">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;x-client-data&#34;</span><span class="p">:</span> <span class="s2">&#34;CJe2yQEIo7bJAQjEtskBCKmdygEInvnLAQjmhMwBCNKPzAEIrZzMAQ==&#34;</span>     <span class="c1"># # ç”±äºè¢«é™åˆ¶ï¼Œä¸è¢«é™åˆ¶å°±ä¸åŠ  éœ€è¦æ›´æ–°</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1"># è§£ææ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="n">obj</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;&lt;em class=&#34;&#34;&gt;(?P&lt;num&gt;.*?)&lt;/em&gt;.*?&#39;</span>
</span></span><span class="line"><span class="cl">                 <span class="sa">r</span><span class="s1">&#39;&lt;div class=&#34;info&#34;&gt;.*?&lt;span class=&#34;title&#34;&gt;(?P&lt;name&gt;.*?)&lt;/span&gt;.*?&#39;</span>
</span></span><span class="line"><span class="cl">                 <span class="sa">r</span><span class="s1">&#39;&lt;p class=&#34;&#34;&gt;.*?&lt;br&gt;(?P&lt;year&gt;.*?)&amp;nbsp.*?&#39;</span>
</span></span><span class="line"><span class="cl">                 <span class="sa">r</span><span class="s1">&#39;property=&#34;v:average&#34;&gt;(?P&lt;rate&gt;.*?)&lt;/span&gt;.*?&#39;</span>
</span></span><span class="line"><span class="cl">                 <span class="sa">r</span><span class="s1">&#39;&lt;span&gt;(?P&lt;people&gt;.*?)&lt;/span&gt;.*?&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">S</span><span class="p">)</span>  <span class="c1"># re.S æ˜¯å…è®¸è·¨è¡Œè¯†åˆ«</span>
</span></span><span class="line"><span class="cl"><span class="c1"># å¦‚æœä¸ä½¿ç”¨re.Så‚æ•°ï¼Œåˆ™åªåœ¨æ¯ä¸€è¡Œå†…è¿›è¡ŒåŒ¹é…ï¼Œå¦‚æœä¸€è¡Œæ²¡æœ‰ï¼Œå°±æ¢ä¸‹ä¸€è¡Œé‡æ–°å¼€å§‹ï¼Œä¸ä¼šè·¨è¡Œã€‚</span>
</span></span><span class="line"><span class="cl"><span class="c1"># è€Œä½¿ç”¨re.Så‚æ•°ä»¥åï¼Œæ­£åˆ™è¡¨è¾¾å¼ä¼šå°†è¿™ä¸ªå­—ç¬¦ä¸²ä½œä¸ºä¸€ä¸ªæ•´ä½“ï¼Œå°†â€œ\nâ€å½“åšä¸€ä¸ªæ™®é€šçš„å­—ç¬¦åŠ å…¥åˆ°è¿™ä¸ªå­—ç¬¦ä¸²ä¸­ï¼Œåœ¨æ•´ä½“ä¸­è¿›è¡ŒåŒ¹é…ã€‚</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç”Ÿæˆcsvæ–‡ä»¶ ä¾¿äºæ•°æ®åˆ†æ</span>
</span></span><span class="line"><span class="cl"><span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;data.csv&#34;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&#34;w&#34;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&#34;utf-8&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">csv_write</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># æ‹¿åˆ°é¡µé¢æºä»£ç </span>
</span></span><span class="line"><span class="cl">    <span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;https://movie.douban.com/top250?start=&#34;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="o">*</span><span class="mi">25</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">paper_text</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="n">text</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># print(resp.text)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># è¿›è¡ŒåŒ¹é…</span>
</span></span><span class="line"><span class="cl">    <span class="n">rect</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">paper_text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">rect</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">dict</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">groupdict</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="nb">dict</span><span class="p">[</span><span class="s2">&#34;year&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">[</span><span class="s2">&#34;year&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">csv_write</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="nb">dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;over!&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># for i in rect:</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#     print(&#34;num:&#34;, i.group(&#34;num&#34;))</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#     print(&#34;name:&#34;, i.group(&#34;name&#34;))</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#     print(&#34;year:&#34;, i.group(&#34;year&#34;).strip())</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#     print(&#34;rate:&#34;, i.group(&#34;rate&#34;))</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#     print(&#34;people:&#34;, i.group(&#34;people&#34;))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="22-bs4è§£æ">2.2 bs4è§£æ</h3>
<blockquote>
<p>&lt;æ ‡ç­¾ å±æ€§=â€œå±æ€§å€¼â€&gt;è¢«æ ‡è®°çš„å†…å®¹&lt;/æ ‡ç­¾&gt;</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">h1</span> <span class="na">align</span><span class="o">=</span><span class="s">&#34;center&#34;</span><span class="p">&gt;</span>i love you<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"># h1: æ ‡ç­¾
</span></span><span class="line"><span class="cl"># align: å±æ€§
</span></span><span class="line"><span class="cl"># center: å±æ€§å€¼
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;http://www.baidu.com&#34;</span><span class="p">&gt;</span>å‘¨æ°ä¼¦<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"># a: æ ‡ç­¾
</span></span><span class="line"><span class="cl"># href: å±æ€§
</span></span><span class="line"><span class="cl"># http: å±æ€§å€¼
</span></span></code></pre></td></tr></table>
</div>
</div><ol>
<li>
<p>æŠŠé¡µé¢æºä»£ç äº¤ç»™BeautifulSoupå¤„ç†ï¼Œç”Ÿæˆbså¯¹è±¡</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">page</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s2">&#34;html.parser&#34;</span><span class="p">)</span> <span class="c1"># æŒ‡å®šhtmlè§£æå™¨</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>ä»bså¯¹è±¡ä¸­æŸ¥æ‰¾æ•°æ®</p>
</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># find(æ ‡ç­¾, å±æ€§=å€¼)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># find_all(æ ‡ç­¾, å±æ€§=å€¼)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;https://movie.douban.com/top250&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;User-Agent&#34;</span><span class="p">:</span> <span class="s2">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;x-client-data&#34;</span><span class="p">:</span> <span class="s2">&#34;CJe2yQEIo7bJAQjEtskBCKmdygEInvnLAQjmhMwBCNKPzAEIrZzMAQ==&#34;</span>  <span class="c1"># # ç”±äºè¢«é™åˆ¶ï¼Œä¸è¢«é™åˆ¶å°±ä¸åŠ  éœ€è¦æ›´æ–°</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># print(resp.text)</span>
</span></span><span class="line"><span class="cl"><span class="n">page_text</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s2">&#34;html.parser&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">pic_list</span> <span class="o">=</span> <span class="n">page_text</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">&#34;div&#34;</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s2">&#34;pic&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">pic_list</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">img_list</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">&#34;img&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">img_list</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># print(img)</span>
</span></span><span class="line"><span class="cl">        <span class="n">name</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;alt&#34;</span><span class="p">)</span>   <span class="c1"># æ‹¿åˆ°åå­—</span>
</span></span><span class="line"><span class="cl">        <span class="n">src</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;src&#34;</span><span class="p">)</span>    <span class="c1"># ç›´æ¥é€šè¿‡getå°±å¯ä»¥æ‹¿åˆ°å±æ€§çš„å€¼, åˆšå¥½æ˜¯å­é¡µé¢çš„ä¸‹è½½è·¯å¾„</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># ä¸‹è½½å›¾ç‰‡</span>
</span></span><span class="line"><span class="cl">        <span class="n">img_resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">img_byte</span> <span class="o">=</span> <span class="n">img_resp</span><span class="o">.</span><span class="n">content</span>    <span class="c1"># è¿™é‡Œæ‹¿åˆ°çš„æ˜¯å­—èŠ‚</span>
</span></span><span class="line"><span class="cl">        <span class="n">img_name</span> <span class="o">=</span> <span class="n">name</span> <span class="o">+</span> <span class="s2">&#34;.jpg&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;img/&#34;</span> <span class="o">+</span> <span class="n">img_name</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&#34;wb&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>   <span class="c1"># å¯¹æ–‡ä»¶å¤¹mark directory as exclude   å¯ä»¥é¿å…pycharmä¸€ç›´å¯¹æ–‡ä»¶è¿›è¡Œç´¢å¼•</span>
</span></span><span class="line"><span class="cl">            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">img_byte</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;over!!&#34;</span><span class="p">,</span> <span class="n">img_name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="23-xpathè§£æ">2.3 Xpathè§£æ</h3>
<blockquote>
<p>xpathæ˜¯åœ¨xmlæ–‡æ¡£ä¸­æœç´¢å†…å®¹çš„ä¸€é—¨è¯­è¨€ï¼Œhtmlæ˜¯xmlçš„ä¸€ä¸ªå­é›†ã€‚</p>
</blockquote>
<p>å®‰è£…lxmlæ¨¡å—ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">conda</span> <span class="n">install</span> <span class="n">lxml</span> 
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">lxml</span> <span class="kn">import</span> <span class="n">etree</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥æŠŠå„çº§æ ‡ç­¾æ¨¡æ‹Ÿä¸ºå„çº§ç›®å½•</p>
<blockquote>
<ol>
<li>ä½¿ç”¨ / è¡¨ç¤ºå±‚çº§å…³ç³»ï¼Œç¬¬ä¸€ä¸ª/è¡¨ç¤ºæ ¹èŠ‚ç‚¹</li>
<li>ä½¿ç”¨ // å–å‡ºæ‰€æœ‰çš„åä»£</li>
<li>/*/ *è¡¨ç¤ºé€šé…ç¬¦ ä»»æ„çš„èŠ‚ç‚¹</li>
<li>/text() å–å‡ºå…¶ä¸­çš„æ–‡æœ¬å†…å®¹</li>
<li>xpathä¸‹æ ‡ä»1å¼€å§‹ [1]</li>
</ol>
</blockquote>
<p>è¯»å–htmlæ–‡ä»¶ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">etree</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&#34;xxx.html&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç­›é€‰å±æ€§ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s2">&#34;/html/body/ul/li[1]/a/text()&#34;</span><span class="p">)</span>   <span class="c1"># å¯ä»¥æ‹¿å‡ºç¬¬ä¸€ä¸ªliæ ‡ç­¾ä¸­aæ ‡ç­¾çš„æ–‡æœ¬</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s2">&#34;/html/body/ul/li/a[@href=&#39;dapao&#39;]/text()&#34;</span><span class="p">)</span>	<span class="c1"># å¯ä»¥æ‹¿å‡ºaæ ‡ç­¾ä¸­å±æ€§href=dapaoçš„æ–‡æœ¬</span>
</span></span><span class="line"><span class="cl"><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s2">&#34;/html/body/ul/li/a/@href&#34;</span><span class="p">)</span>		<span class="c1"># æ‹¿å‡ºæ ‡ç­¾açš„æ‰€æœ‰hrefå±æ€§</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿”å›åˆ—è¡¨ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">ol_li_list</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s2">&#34;/html/body/ol/li&#34;</span><span class="p">)</span>	<span class="c1"># è¿”å›liæ ‡ç­¾åˆ—è¡¨</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">li</span> <span class="ow">in</span> <span class="n">ol_li_list</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># ä½¿ç”¨ .è¡¨ç¤ºç›¸å¯¹è·¯å¾„   ç›¸å½“äºliå…¶å®</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="n">li</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s2">&#34;./a/text()&#34;</span><span class="p">)</span>	<span class="c1"># å–liä¸­aæ ‡ç­¾çš„æ–‡æœ¬ï¼Œç›¸å¯¹æŸ¥æ‰¾</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="n">li</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s2">&#34;./a/@href&#34;</span><span class="p">)</span>	<span class="c1"># æ‹¿åˆ°å±æ€§å€¼: @å±æ€§</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æ‹¿åˆ°é¡µé¢æºä»£ç </span>
</span></span><span class="line"><span class="cl"><span class="c1"># æå–å’Œè§£ææ•°æ®</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">lxml</span> <span class="kn">import</span> <span class="n">etree</span>
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;https://nanjing.zbj.com/search/f/?kw=saas&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># print(resp.text)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># è§£æ</span>
</span></span><span class="line"><span class="cl"><span class="n">html</span> <span class="o">=</span> <span class="n">etree</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">div_list</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s2">&#34;/html/body/div[6]/div/div/div[2]/div[5]/div[1]/div&#34;</span><span class="p">)</span>     <span class="c1"># æ‹¿åˆ°æ¯ä¸€ä¸ªæœåŠ¡å•†çš„divæ ‡ç­¾</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">div</span> <span class="ow">in</span> <span class="n">div_list</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">price</span> <span class="o">=</span> <span class="n">div</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s2">&#34;./div/div/a[2]/div[2]/div[1]/span[1]/text()&#34;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&#34;Â¥&#34;</span><span class="p">)</span>  <span class="c1"># price: [&#39;Â¥898&#39;]  ä½¿ç”¨strip()å¤„ç†æ•°æ®</span>
</span></span><span class="line"><span class="cl">    <span class="n">title</span> <span class="o">=</span> <span class="s2">&#34;SaaS&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">div</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s2">&#34;./div/div/a[2]/div[2]/div[2]/p/text()&#34;</span><span class="p">))</span>     <span class="c1"># [&#39;è½¯ä»¶å¼€å‘/OA/è½¯ä»¶å®šåˆ¶å¼€å‘/&#39;, &#39;è½¯ä»¶/åŸç”Ÿæ··åˆ/ç‰©è”ç½‘&#39;] ä¸­é—´åº”è¯¥æ˜¯æœ‰SasSçš„ ä½†æ˜¯æ²¡æœ‰æå–å‡ºæ¥  å› æ­¤ç”¨joinè¿›è¡Œæ‹¼æ¥</span>
</span></span><span class="line"><span class="cl">    <span class="n">company</span> <span class="o">=</span> <span class="n">div</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s2">&#34;./div/div/a[1]/div[1]/p/text()&#34;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>                      <span class="c1"># company: [&#39;\n\n&#39;, &#39;\n\nå½¬è¾¾ç§‘æŠ€&#39;]  ä½¿ç”¨strip()å¯ä»¥ç›´æ¥å»æ‰\n</span>
</span></span><span class="line"><span class="cl">    <span class="n">location</span> <span class="o">=</span> <span class="n">div</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s2">&#34;./div/div/a[1]/div[1]/div/span/text()&#34;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;title:&#34;</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="s2">&#34;price:&#34;</span><span class="p">,</span> <span class="n">price</span><span class="p">,</span> <span class="s2">&#34;company:&#34;</span><span class="p">,</span> <span class="n">company</span><span class="p">,</span> <span class="s2">&#34;location:&#34;</span><span class="p">,</span> <span class="n">location</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ä¸‰requestè¿›é˜¶">ä¸‰ã€requestè¿›é˜¶</h2>
<h3 id="31-æ¨¡æ‹Ÿç™»å½•-cookie">3.1 æ¨¡æ‹Ÿç™»å½•-cookie</h3>
<p>å‘ç°è®¿é—®è¯¥ç½‘ç«™å¯ä»¥å¾—åˆ°<code>cookie</code>ï¼Œæ³¨æ„ï¼š<code>cookie</code>ä¸€èˆ¬ä¸ä¼šåœ¨ <code>é¢„è§ˆ </code>ä¸­ï¼Œ ä¸€èˆ¬åœ¨ <code>å“åº”æ ‡å¤´</code> ä¸­</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220513160421732.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220513160421732.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220513160421732.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220513160421732.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220513160421732.png"
        title="image-20220513160421732" /></p>
<p>å› æ­¤å¯ä»¥<code>POST</code>è¯¥ç½‘ç«™å¾—åˆ°cookie</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">    <span class="c1"># è·å¾—cookieï¼Œæ„é€ headers</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">get_cookie</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">cookie_url</span> <span class="o">=</span> <span class="s2">&#34;http://ehall.seu.edu.cn/ygfw/sys/swpubapp/xxx&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cookie_response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">cookie_url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;USERID&#34;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_info</span><span class="o">.</span><span class="n">user_id</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">		<span class="c1"># å°†cookiesè½¬åŒ–ä¸ºå­—å…¸æ ¼å¼</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">cookie_response</span><span class="o">.</span><span class="n">cookies</span><span class="o">.</span><span class="n">get_dict</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">$</span> <span class="n">python</span> <span class="n">main</span><span class="o">.</span><span class="n">py</span>
</span></span><span class="line"><span class="cl"><span class="n">å¾—åˆ°Cookie</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">NSC_ESNS</span><span class="o">=</span><span class="mi">57</span><span class="n">d88235</span><span class="o">-</span><span class="mi">1</span><span class="n">b4a</span><span class="o">-</span><span class="mf">127e-9678</span><span class="o">-</span><span class="mf">00e0</span><span class="n">ed9d66bd_2375465377_1978659927_00000000005768517823</span><span class="p">;</span> 				<span class="n">NSC_JOqgyvhaegq01uld2umxhgbeip03kb0</span><span class="o">=</span><span class="n">ffffffff09489f1745525d5f4f58455e445a4a423660</span><span class="p">;</span> <span class="n">_WEU</span><span class="o">=</span><span class="n">tbZT</span>
</span></span><span class="line"><span class="cl">	<span class="n">ZDIpO9DfzKWosRmHWCxuajrVVDsuty8Dy6k2GDK0hXp7irsDDNISCgMQIZQTK</span><span class="o">*</span><span class="n">DeyDKn7eS0h2lzXOQEjo</span><span class="o">..</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä½†æ­¤æ—¶çš„Cookieä¸å¤Ÿï¼Œè¿˜ç¼ºå°‘</p>
<img src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220513165255251.png" alt="image-20220513165255251" style="zoom:67%;" />
<p>å½“é‡æ–°ç™»å½•å¹¶æŠ“åŒ…ï¼Œå¯ä»¥å‘ç°çº¢è‰²æ¡†ä¸­çš„Cookieåœ¨é¦–æ¬¡ç™»é™†æ—¶è·å¾—ï¼š</p>
<img src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220513165349310.png" alt="image-20220513165349310" style="zoom:67%;" />
<p>å› æ­¤åœ¨loginçš„æ—¶å€™ï¼Œå°±åº”è¯¥ä¿å­˜è¯¥Cookieã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"></code></pre></td></tr></table>
</div>
</div><p>æäº¤è¡¨å•éœ€è¦ç¼–ç ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;application/x-www-form-urlencoded; charset=UTF-8&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">post_info</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="32-é˜²ç›—é“¾">3.2 é˜²ç›—é“¾</h3>
<p>Referer: â€œâ€   ç”¨äºéªŒè¯ä½ çš„èµ„æºé“¾æ¥æ˜¯ä»å“ªæ¥çš„ï¼Ÿ ç›¸å½“äºæº¯æº</p>
<p>ä»æ¢¨è§†é¢‘ç½‘ç«™ä¸‹è½½è§†é¢‘ æµç¨‹ï¼š</p>
<ol>
<li>æ‹¿åˆ°è¯·æ±‚ç½‘å€å’ŒcontID</li>
</ol>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228095048876.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228095048876.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228095048876.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228095048876.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228095048876.png"
        title="image-20220228095048876" /></p>
<ol start="2">
<li>æ‹¿åˆ°videoStatusè¿”å›çš„.json &ndash;&gt; srcUrl</li>
</ol>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220225110624940.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220225110624940.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220225110624940.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220225110624940.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220225110624940.png"
        title="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220225110624940.png" /></p>
<ol start="3">
<li>ä¿®æ­£srcUrl</li>
</ol>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220225110714800.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220225110714800.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220225110714800.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220225110714800.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220225110714800.png"
        title="image-20220225110714800" /></p>
<ol start="4">
<li>ä¸‹è½½è§†é¢‘</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># 1. æ‹¿åˆ°contID</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 2. æ‹¿åˆ°videoStatusè¿”å›çš„.json --&gt; srcUrl</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 3. ä¿®æ­£srcUrl</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 4. ä¸‹è½½è§†é¢‘</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ‹‰å–è§†é¢‘èµ„æºç½‘ç«™</span>
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;https://www.pearvideo.com/video_1752547&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">url_cont</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;_&#34;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>    <span class="c1"># ä»¥ _ åˆ†å‰²ä¸ºä¸¤ä¸ªå…ƒç´ ï¼Œå–ç¬¬äºŒä¸ª</span>
</span></span><span class="line"><span class="cl"><span class="n">video_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;https://www.pearvideo.com/videoStatus.jsp?contId=</span><span class="si">{</span><span class="n">url_cont</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;User-Agent&#34;</span><span class="p">:</span> <span class="s2">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;Referer&#34;</span><span class="p">:</span> <span class="n">url</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1"># æ‹¿åˆ°å“åº”åŒ…</span>
</span></span><span class="line"><span class="cl"><span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">video_url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ä»ç½‘ç»œå“åº”åŒ…ä¸­æ‰¾åˆ°ç½‘ç»œèµ„æºåœ°å€ï¼š</span>
</span></span><span class="line"><span class="cl"><span class="c1"># https://video.pearvideo.com/mp4/adshort/20220222/1646013336252-15830346_adpkg-ad_hd.mp4</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ä»https://www.pearvideo.com/video_1658861çš„é¡µé¢å…ƒç´ ä¸­æ‰¾åˆ°è§†é¢‘åœ°å€ä¸ºï¼š</span>
</span></span><span class="line"><span class="cl"><span class="c1"># https://video.pearvideo.com/mp4/adshort/20220222/cont-1752547-15830346_adpkg-ad_hd.mp4</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">dic</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">srcUrl</span> <span class="o">=</span> <span class="n">dic</span><span class="p">[</span><span class="s1">&#39;videoInfo&#39;</span><span class="p">][</span><span class="s1">&#39;videos&#39;</span><span class="p">][</span><span class="s1">&#39;srcUrl&#39;</span><span class="p">]</span>  <span class="c1"># æ‹¿åˆ°çš„ç½‘å€å¹¶ä¸èƒ½ç›´æ¥ä½¿ç”¨ï¼Œé€šè¿‡ä»¥ä¸Šçš„å¯¹æ¯”è¿›è¡Œä¿®æ”¹</span>
</span></span><span class="line"><span class="cl"><span class="n">sysTime</span> <span class="o">=</span> <span class="n">dic</span><span class="p">[</span><span class="s1">&#39;systemTime&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ä¿®æ”¹srcUrl</span>
</span></span><span class="line"><span class="cl"><span class="n">srcUrl</span> <span class="o">=</span> <span class="n">srcUrl</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">sysTime</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&#34;cont-</span><span class="si">{</span><span class="n">url_cont</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">srcUrl</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># è¯·æ±‚videoèµ„æº</span>
</span></span><span class="line"><span class="cl"><span class="n">video</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">srcUrl</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;a.mp4&#34;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&#34;wb&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">video</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Over!!&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>é€šè¿‡å¯¹æ¯”ï¼Œå‘ç°åªæœ‰ cont-1658861 ä¸ä¸€æ ·ï¼Œå¹¶ä¸”contåé¢çš„æ•°å­—å’ŒåŸé“¾æ¥æœ€åçš„æ•°å­—ç›¸åŒï¼Œå› æ­¤å¯¹å“åº”åŒ…ä¸­çš„èµ„æºurlè¿›è¡Œä¿®æ­£ã€‚</p>
<h3 id="33-ä»£ç†">3.3 ä»£ç†</h3>
<p>åŸç†ï¼š</p>
<blockquote>
<p>é€šè¿‡ç¬¬ä¸‰æ–¹çš„æœºå™¨å»å‘é€è¯·æ±‚</p>
</blockquote>
<h3 id="34-ç½‘æ˜“äº‘è¯„è®º">3.4 ç½‘æ˜“äº‘è¯„è®º</h3>
<p>é‡Œè¾¹ç”¨åˆ°åŠ å¯†ç®—æ³•ï¼Œéœ€è¦å®‰è£…ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">conda</span> <span class="n">install</span> <span class="n">pycrypto</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">AES</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è€ƒè™‘è¿‡ç¨‹ä¸ºï¼š</p>
<ol>
<li>æ‰¾åˆ°æœªåŠ å¯†çš„å‚æ•°</li>
<li>æƒ³åŠæ³•å¯¹å‚æ•°è¿›è¡ŒåŠ å¯†ï¼ˆæŒ‰ç…§ç½‘æ˜“çš„åŠ å¯†æ–¹æ³•ï¼‰ï¼Œparamså’ŒencSecKey</li>
<li>è¯·æ±‚åˆ°ç½‘æ˜“ï¼Œæ‹¿åˆ°è¯„è®ºä¿¡æ¯</li>
</ol>
<p>æ‰¾åˆ°è¯„è®ºæ‰€åœ¨è¯·æ±‚ï¼š</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228104640739.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228104640739.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228104640739.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228104640739.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228104640739.png"
        title="image-20220228104640739" /></p>
<p>æ‰¾åˆ°è¯·æ±‚è¯„è®ºçš„é“¾æ¥ï¼š</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228105427485.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228105427485.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228105427485.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228105427485.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228105427485.png"
        title="image-20220228105427485" /></p>
<p>å› ä¸ºè¯·æ±‚æ–¹æ³•æ˜¯Postï¼Œå‘ç°è¡¨å•æ•°æ®è¢«åŠ å¯†ï¼š</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228105237796.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228105237796.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228105237796.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228105237796.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228105237796.png"
        title="image-20220228105237796" /></p>
<p>æŸ¥çœ‹ç¨‹åºè°ƒç”¨å †æ ˆã€‚é€‰å–æœ€ä¸Šé¢é‚£ä¸ªã€‚å› ä¸ºä»–æ˜¯æœ€åæ‰§è¡Œçš„ï¼Œä¹Ÿå°±æ˜¯å‘é€æ•°æ®çš„ï¼š</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228112248871.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228112248871.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228112248871.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228112248871.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228112248871.png"
        title="image-20220228112248871" /></p>
<p>å®Œäº‹è¿›å»ä¹‹åå‘ç°ç¨‹åºåœç•™åœ¨è¿™ä¸€è¡Œï¼Œåˆšå¥½æ˜¯sendï¼Œåœ¨è¿™ä¸€è¡Œè®¾ç½®ç¨‹åºæ–­ç‚¹ï¼š</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228112137142.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228112137142.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228112137142.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228112137142.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228112137142.png"
        title="image-20220228112137142" /></p>
<p>æŸ¥çœ‹å½“å‰è¯·æ±‚çš„urlï¼Œå‘ç°å’Œæˆ‘ä»¬æƒ³è¦çš„è¯„è®ºurlä¸åŒï¼š</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228112735702.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228112735702.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228112735702.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228112735702.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228112735702.png"
        title="image-20220228112735702" /></p>
<p>ç»§ç»­æ‰§è¡Œï¼Œç›´åˆ°æˆ‘ä»¬æƒ³è¦çš„urlä¸ºæ­¢ï¼Œæ­¤æ—¶dataé‡Œçš„paramè¢«åŠ å¯†ï¼š</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228112927837.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228112927837.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228112927837.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228112927837.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228112927837.png"
        title="image-20220228112927837" /></p>
<p>éœ€è¦å¾€å›æ‰¾æœªåŠ å¯†çš„ï¼Œé€šè¿‡ è°ƒç”¨å †æ ˆ å¾€ä¸Šæ‰¾ï¼š</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228113313254.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228113313254.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228113313254.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228113313254.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228113313254.png"
        title="image-20220228113313254" /></p>
<p>æ‰“å¼€ä¹‹åå‘ç°ä¾ç„¶æ˜¯åŠ å¯†çš„ï¼š</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228143828196.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228143828196.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228143828196.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228143828196.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228143828196.png"
        title="image-20220228143828196" /></p>
<p>é‚£ä¹ˆéœ€è¦å†å¾€ä¸Šæ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°æœªåŠ å¯†çš„å‚æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨ä¸‹ä¸€å±‚t0x.be0xä¸­æ•°æ®æ‰è¢«åŠ å¯†ï¼š</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228144023553.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228144023553.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228144023553.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228144023553.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228144023553.png"
        title="image-20220228144023553" /></p>
<p>é‚£ä¹ˆå›åˆ°ä¸Šä¸€å±‚ä¸­ï¼Œæ‰¾åˆ°é›†ä½“åœ¨ä½•å¤„è¢«åŠ å¯†ï¼š</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228144352363.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228144352363.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228144352363.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228144352363.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228144352363.png"
        title="image-20220228144352363" /></p>
<p>åœ¨å‡½æ•°ä¸­é€è¡Œè®¾ç½®æ–­ç‚¹ï¼Œæ…¢æ…¢æ£€æµ‹åœ¨ä½•å¤„æ•°æ®è¢«åŠ å¯†ï¼š</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228145014406.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228145014406.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228145014406.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228145014406.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228145014406.png"
        title="image-20220228145014406" /></p>
<p>ä½¿ç”¨å›¾ä¸­æŒ‰é’®å¯ä»¥é€è¡Œæ£€æµ‹ä»£ç ç»“æœï¼Œåœ¨window&hellip;è¿™ä¸€è¡Œè¿˜æ˜¯æ˜æ–‡ï¼š</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228155519551.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228155519551.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228155519551.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228155519551.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228155519551.png"
        title="image-20220228155519551" /></p>
<p>åˆ°äº†ä¸‹ä¸€è¡Œï¼Œå‚æ•°è¢«åŠ å¯†ï¼Œå› æ­¤å¯ä»¥æ–­å®šåŠ å¯†å‡½æ•°æ˜¯window&hellip;ï¼Œå¹¶å¯ä»¥å¾—åˆ°åŸæ–‡ï¼š</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228155635105.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228155635105.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228155635105.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228155635105.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228155635105.png"
        title="image-20220228155635105" /></p>
<p>å¯ä»¥çœ‹å‡ºï¼Œparams ==&gt; encTextï¼ŒencSecKey ==&gt; encSecKeyï¼š</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228152032516.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228152032516.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228152032516.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228152032516.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228152032516.png"
        title="image-20220228152032516" /></p>
<p>å–åŠ å¯†å‡½æ•°ï¼š</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228161314968.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228161314968.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228161314968.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228161314968.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228161314968.png"
        title="image-20220228161314968" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228161536508.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228161536508.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228161536508.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228161536508.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228161536508.png"
        title="image-20220228161536508" /></p>
<p>æ³¨æ„åŸå‡½æ•°é‡Œé¢çš„å‚æ•°ï¼Œéœ€è¦ç»™ä»–é…é½ï¼Œå¯¹åº”ç€è°ƒç”¨å¤„çš„å®å‚ï¼Œå¯ä»¥å¯¹å…¶è¿›è¡Œèµ‹å€¼ï¼š</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228161739509.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228161739509.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228161739509.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228161739509.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228161739509.png"
        title="image-20220228161739509" /></p>
<p>é€šè¿‡åœ¨æ§åˆ¶å°è¿è¡Œï¼Œå¯ä»¥å¾—åˆ°å…¶ä»–å‚æ•°ï¼š</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228161847193.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228161847193.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228161847193.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228161847193.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228161847193.png"
        title="image-20220228161847193" /></p>
<p>æˆ–è€…é€šè¿‡ä»¥ä¸‹æ–¹å¼ä¹Ÿå¯ä»¥å¾—åˆ°å‚æ•°ï¼š</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228192455256.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228192455256.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228192455256.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228192455256.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228192455256.png"
        title="image-20220228192455256" /></p>
<p>è®¾ç½®æ–­ç‚¹æ‹¿åˆ°ä»¥ä¸‹å‚æ•°ï¼š</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228193251392.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228193251392.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228193251392.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228193251392.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220228193251392.png"
        title="image-20220228193251392" /></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æ‰¾åˆ°æœªåŠ å¯†çš„å‚æ•°</span>
</span></span><span class="line"><span class="cl"><span class="c1"># æƒ³åŠæ³•æŠŠå‚æ•°è¿›è¡ŒåŠ å¯†ï¼ˆå¿…é¡»å‚è€ƒç½‘æ˜“çš„é€»è¾‘ï¼‰ï¼Œparamsï¼ŒencSecKey</span>
</span></span><span class="line"><span class="cl"><span class="c1"># è¯·æ±‚åˆ°ç½‘æ˜“ æ‹¿åˆ°è¯„è®ºä¿¡æ¯</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">AES</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">base64</span> <span class="kn">import</span> <span class="n">b64encode</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;https://music.163.com/weapi/comment/resource/comments/get?csrf_token=&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># è¯·æ±‚æ–¹æ³•æ˜¯POST</span>
</span></span><span class="line"><span class="cl"><span class="c1"># æ‰¾åˆ°çœŸå®å‚æ•°</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">e</span> <span class="o">=</span> <span class="s1">&#39;010001&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">f</span> <span class="o">=</span> <span class="s1">&#39;00e0b509f6259df8642dbc35662901477df22677ec152b5ff68ace615bb7b725152b3ab17a876aea8a5aa76d2e417629ec4ee341&#39;</span> \
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;f56135fccf695280104e0312ecbda92557c93870114af6c9d05c4f7f0c3685b7a46bee255932575cce10b424d813cfe4875d3e82&#39;</span> \
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;047b97ddef52741d546b8e289dc6935b3ece0462db0a22b8e7&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">g</span> <span class="o">=</span> <span class="s1">&#39;0CoJUm6Qyw8W8jud&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># iæ˜¯ä¸ªéšæœºå€¼ï¼Œå› æ­¤æˆ‘ä»¬åªèƒ½å»å“åº”åŒ…ä¸­æ‹¿å–i</span>
</span></span><span class="line"><span class="cl"><span class="n">i</span> <span class="o">=</span> <span class="s1">&#39;9bdHkFpLbUCNTAnl&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ä¸ºäº†ç®€åŒ–è¿ç®—ï¼ˆä¸æƒ³å¤„ç†cå‡½æ•°ï¼‰ï¼Œè®¾ç½®ä¸ºå›ºå®šçš„   iå›ºå®š åˆ™å®ƒä¹Ÿå›ºå®š</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_encSecKey</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s2">&#34;1eb5a1efb12baafd580884b5c41b0a5bbbaee1c0de49f9d0470f05aa2a9215c25563b0ad5da008dacd85f65e0406addbd&#34;</span> \
</span></span><span class="line"><span class="cl">           <span class="s2">&#34;a43bbe77716896089f607826000aa4797f34e03e8eb822096c166ec8ae4463ec1f7dab60c045eff18dfdef9f78555301f&#34;</span> \
</span></span><span class="line"><span class="cl">           <span class="s2">&#34;3107d521918fea66940b6589749b9db575afa03f74ec04d01f1726f22ba1d2&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_params</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># æ­¤å¤„çš„dataéœ€è¦æ˜¯å­—ç¬¦ä¸²æ ¼å¼ï¼Œä¸èƒ½æ˜¯å­—å…¸æ ¼å¼ï¼Œå› æ­¤éœ€è¦ä½¿ç”¨jsonè½¬æ¢</span>
</span></span><span class="line"><span class="cl">    <span class="n">first</span> <span class="o">=</span> <span class="n">enc_params</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">params</span> <span class="o">=</span> <span class="n">enc_params</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">params</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">enc_params</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>   <span class="c1"># åŠ å¯†è¿‡ç¨‹</span>
</span></span><span class="line"><span class="cl">    <span class="n">iv</span> <span class="o">=</span> <span class="s2">&#34;0102030405060708&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">aes</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&#34;utf-8&#34;</span><span class="p">),</span> <span class="n">IV</span><span class="o">=</span><span class="n">iv</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&#34;utf-8&#34;</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="n">AES</span><span class="o">.</span><span class="n">MODE_CBC</span><span class="p">)</span>     <span class="c1"># åˆ›å»ºä¸€ä¸ªAESå¯¹è±¡</span>
</span></span><span class="line"><span class="cl">    <span class="n">bs</span> <span class="o">=</span> <span class="n">aes</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">to_16</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>   <span class="c1"># åŠ å¯†ï¼ŒåŠ å¯†å†…å®¹å¿…é¡»æ˜¯16çš„å€æ•°</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># ç”±äºåŠ å¯†ç»“æœæ˜¯ä¸èƒ½ç›´æ¥è½¬ä¸ºå­—ç¬¦ä¸²çš„ï¼Œéœ€è¦å…ˆè½¬åŒ–ä¸ºbase64æ‰è¡Œï¼Œç„¶åå†è½¬åŒ–ä¸ºå­—ç¬¦ä¸²</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">b64encode</span><span class="p">(</span><span class="n">bs</span><span class="p">),</span> <span class="s2">&#34;utf-8&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">to_16</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">pam</span> <span class="o">=</span> <span class="mi">16</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">%</span> <span class="mi">16</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">pam</span><span class="p">)</span> <span class="o">*</span> <span class="n">pam</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">data</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¿›è¡ŒåŠ å¯†è¿‡ç¨‹</span>
</span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    function a(a = 16) {    # éšæœºäº§ç”Ÿ16ä½éšæœºç 
</span></span></span><span class="line"><span class="cl"><span class="s2">        var d, e, b = &#34;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#34;, c = &#34;&#34;;
</span></span></span><span class="line"><span class="cl"><span class="s2">        for (d = 0; a &gt; d; d += 1)  # éšæœº16æ¬¡
</span></span></span><span class="line"><span class="cl"><span class="s2">            e = Math.random() * b.length,   # éšæœºæ•°
</span></span></span><span class="line"><span class="cl"><span class="s2">            e = Math.floor(e),     # å–æ•´
</span></span></span><span class="line"><span class="cl"><span class="s2">            c += b.charAt(e);     # å»å­—ç¬¦ä¸²ä¸­çš„xxxä½ç½® b
</span></span></span><span class="line"><span class="cl"><span class="s2">        return c
</span></span></span><span class="line"><span class="cl"><span class="s2">    }
</span></span></span><span class="line"><span class="cl"><span class="s2">    function b(a, b) {
</span></span></span><span class="line"><span class="cl"><span class="s2">        var c = CryptoJS.enc.Utf8.parse(b)
</span></span></span><span class="line"><span class="cl"><span class="s2">          , d = CryptoJS.enc.Utf8.parse(&#34;0102030405060708&#34;)
</span></span></span><span class="line"><span class="cl"><span class="s2">          , e = CryptoJS.enc.Utf8.parse(a)
</span></span></span><span class="line"><span class="cl"><span class="s2">          , f = CryptoJS.AES.encrypt(e, c, {    # AESç®—æ³• eåŸæ–‡ï¼Œcæ˜¯å¯†é’¥
</span></span></span><span class="line"><span class="cl"><span class="s2">            iv: d,      # åç§»é‡
</span></span></span><span class="line"><span class="cl"><span class="s2">            mode: CryptoJS.mode.CBC     # æ¨¡å¼ï¼šCBC
</span></span></span><span class="line"><span class="cl"><span class="s2">        });
</span></span></span><span class="line"><span class="cl"><span class="s2">        return f.toString()
</span></span></span><span class="line"><span class="cl"><span class="s2">    }
</span></span></span><span class="line"><span class="cl"><span class="s2">    function c(a, b, c) {
</span></span></span><span class="line"><span class="cl"><span class="s2">        var d, e;
</span></span></span><span class="line"><span class="cl"><span class="s2">        return setMaxDigits(131),
</span></span></span><span class="line"><span class="cl"><span class="s2">        d = new RSAKeyPair(b,&#34;&#34;,c),
</span></span></span><span class="line"><span class="cl"><span class="s2">        e = encryptedString(d, a)
</span></span></span><span class="line"><span class="cl"><span class="s2">    }
</span></span></span><span class="line"><span class="cl"><span class="s2">    function d(d, e, f, g) {  # d:data, e:&#39;010001&#39;, f:å¾ˆé•¿, g:&#39;0CoJUm6Qyw8W8jud&#39;
</span></span></span><span class="line"><span class="cl"><span class="s2">        var h = </span><span class="si">{}</span><span class="s2">   # è®¾ç½®ä¸€ä¸ªç©ºå¯¹è±¡
</span></span></span><span class="line"><span class="cl"><span class="s2">          , i = a(16);  # iå°±æ˜¯ä¸€ä¸ªéšæœºå€¼
</span></span></span><span class="line"><span class="cl"><span class="s2">        return h.encText = b(d, g),  # g å½“ä½œå¯†é’¥ 
</span></span></span><span class="line"><span class="cl"><span class="s2">        h.encText = b(h.encText, i),  # è¿”å›çš„å°±æ˜¯params
</span></span></span><span class="line"><span class="cl"><span class="s2">        h.encSecKey = c(i, e, f),     # è¿”å›çš„å°±æ˜¯encSecKey   å…¶ä¸­eã€féƒ½æ˜¯å®šæ­»çš„ï¼Œåªæœ‰iæ˜¯å˜é‡ï¼Œè‹¥å›ºå®šiï¼Œåˆ™å¾—åˆ°çš„keyä¸€å®šæ˜¯å›ºå®šçš„
</span></span></span><span class="line"><span class="cl"><span class="s2">        h
</span></span></span><span class="line"><span class="cl"><span class="s2">    }
</span></span></span><span class="line"><span class="cl"><span class="s2">    function e(a, b, d, e) {
</span></span></span><span class="line"><span class="cl"><span class="s2">        var f = </span><span class="si">{}</span><span class="s2">;
</span></span></span><span class="line"><span class="cl"><span class="s2">        return f.encText = c(a + e, b, d),
</span></span></span><span class="line"><span class="cl"><span class="s2">        f
</span></span></span><span class="line"><span class="cl"><span class="s2">    }
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_comments</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">song_id</span><span class="p">,</span> <span class="n">page_num</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">rid</span> <span class="o">=</span> <span class="s2">&#34;R_SO_4_&#34;</span> <span class="o">+</span> <span class="n">song_id</span>
</span></span><span class="line"><span class="cl">    <span class="n">threadId</span> <span class="o">=</span> <span class="s2">&#34;R_SO_4_&#34;</span> <span class="o">+</span> <span class="n">song_id</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;cursor&#34;</span><span class="p">:</span> <span class="s2">&#34;-1&#34;</span><span class="p">,</span>  <span class="c1"># è¿™ä¸ªå’ŒpaperNoå…±åŒå†³å®šå“ªä¸€é¡µçš„è¯„è®º1610629253639  1621187632097</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;offset&#34;</span><span class="p">:</span> <span class="n">page_num</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">%</span> <span class="mi">200</span><span class="p">,</span>  <span class="c1"># ä»£è¡¨æœ€æ–°è¯„è®ºçš„é¡µæ•°</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;orderType&#34;</span><span class="p">:</span> <span class="s2">&#34;1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;pageNo&#34;</span><span class="p">:</span> <span class="n">page_num</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>  <span class="c1"># ä»£è¡¨çƒ­è¯„çš„é¡µæ•°</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;pageSize&#34;</span><span class="p">:</span> <span class="s2">&#34;20&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;rid&#34;</span><span class="p">:</span> <span class="n">rid</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;threadId&#34;</span><span class="p">:</span> <span class="n">threadId</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;params&#34;</span><span class="p">:</span> <span class="n">get_params</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">)),</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;encSecKey&#34;</span><span class="p">:</span> <span class="n">get_encSecKey</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">})</span>
</span></span><span class="line"><span class="cl">    <span class="n">source</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&#34;data&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># print(source)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">source</span><span class="p">[</span><span class="s2">&#34;hotComments&#34;</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">page_num</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;=====hotComments=====&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">hot_comment</span> <span class="ow">in</span> <span class="n">source</span><span class="p">[</span><span class="s2">&#34;hotComments&#34;</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="n">hot_comment</span><span class="p">[</span><span class="s2">&#34;user&#34;</span><span class="p">][</span><span class="s2">&#34;nickname&#34;</span><span class="p">],</span> <span class="s2">&#34;:&#34;</span><span class="p">,</span> <span class="n">hot_comment</span><span class="p">[</span><span class="s2">&#34;content&#34;</span><span class="p">],</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">time:&#34;</span><span class="p">,</span> <span class="n">hot_comment</span><span class="p">[</span><span class="s2">&#34;timeStr&#34;</span><span class="p">],</span> <span class="s2">&#34;ç‚¹èµæ•°:&#34;</span><span class="p">,</span> <span class="n">hot_comment</span><span class="p">[</span><span class="s2">&#34;likedCount&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;-&#34;</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">elif</span> <span class="n">source</span><span class="p">[</span><span class="s2">&#34;comments&#34;</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;=====latestComments=====&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">latest_comment</span> <span class="ow">in</span> <span class="n">source</span><span class="p">[</span><span class="s2">&#34;comments&#34;</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="n">latest_comment</span><span class="p">[</span><span class="s2">&#34;user&#34;</span><span class="p">][</span><span class="s2">&#34;nickname&#34;</span><span class="p">],</span> <span class="s2">&#34;:&#34;</span><span class="p">,</span> <span class="n">latest_comment</span><span class="p">[</span><span class="s2">&#34;content&#34;</span><span class="p">],</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">time:&#34;</span><span class="p">,</span> <span class="n">latest_comment</span><span class="p">[</span><span class="s2">&#34;timeStr&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;-&#34;</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;nil&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># for num in range(1, 34):</span>
</span></span><span class="line"><span class="cl"><span class="c1">#     get_comments(url, num)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">song_id</span> <span class="o">=</span> <span class="s2">&#34;1923184888&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">page_num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;*****ç¬¬</span><span class="si">{</span><span class="n">page_num</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">é¡µ*****&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">get_comments</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">song_id</span><span class="p">,</span> <span class="n">page_num</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&#34;nil&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;over!!!&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="å››åŠ é€Ÿ">å››ã€åŠ é€Ÿ</h2>
<blockquote>
<p>è¿›ç¨‹æ˜¯ä¸€ä¸ªèµ„æºå•ä½ï¼Œçº¿ç¨‹æ˜¯ä¸€ä¸ªæ‰§è¡Œå•ä½</p>
<p>eg: xxxè¿›ç¨‹åŒ…å«å¤šä¸ªçº¿ç¨‹ï¼›ä¸€ä¸ªé¡¹ç›®ç»„ï¼ˆè¿›ç¨‹ï¼‰åŒ…å«å¤šä¸ªå·¥ä½œäººå‘˜ï¼ˆçº¿ç¨‹ï¼‰ï¼›</p>
</blockquote>
<h3 id="41-å¤šçº¿ç¨‹">4.1 å¤šçº¿ç¨‹</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># å¤šçº¿ç¨‹</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">threading</span> <span class="kn">import</span> <span class="n">Thread</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">MyThread</span><span class="p">(</span><span class="n">Thread</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># å›ºå®šçš„ï¼Œ  -&gt; å½“çº¿ç¨‹è¢«æ‰§è¡Œçš„æ—¶å€™ï¼Œè¢«æ‰§è¡Œçš„å°±æ˜¯run()</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;å­çº¿ç¨‹: &#34;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">t</span> <span class="o">=</span> <span class="n">MyThread</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># t.run()  # è¿™ç§æ–¹æ³•æ˜¯è°ƒç”¨æ–¹æ³•ï¼Œä¾ç„¶æ˜¯å•çº¿ç¨‹</span>
</span></span><span class="line"><span class="cl">    <span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>  <span class="c1"># å¼€å¯çº¿ç¨‹ï¼Œçº¿ç¨‹æ­¤æ—¶å¯ä»¥å¼€å§‹å·¥ä½œï¼Œä½†ä¸å¿…é¡»ï¼Œå…·ä½“æ‰§è¡Œæ—¶é—´ç”±CPUå†³å®š</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;ä¸»çº¿ç¨‹:&#34;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl"><span class="c1"># =========é‡å‘½å=========      </span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">MyThread</span><span class="p">(</span><span class="n">Thread</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">Thread</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># å›ºå®šçš„ï¼Œ  -&gt; å½“çº¿ç¨‹è¢«æ‰§è¡Œçš„æ—¶å€™ï¼Œè¢«æ‰§è¡Œçš„å°±æ˜¯run()</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getName</span><span class="p">(),</span> <span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">t1</span> <span class="o">=</span> <span class="n">MyThread</span><span class="p">(</span><span class="s2">&#34;wlh&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># t.run()  # è¿™ç§æ–¹æ³•æ˜¯è°ƒç”¨æ–¹æ³•ï¼Œä¾ç„¶æ˜¯å•çº¿ç¨‹</span>
</span></span><span class="line"><span class="cl">    <span class="n">t1</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>  <span class="c1"># å¼€å¯çº¿ç¨‹ï¼Œçº¿ç¨‹æ­¤æ—¶å¯ä»¥å¼€å§‹å·¥ä½œï¼Œä½†ä¸å¿…é¡»ï¼Œå…·ä½“æ‰§è¡Œæ—¶é—´ç”±CPUå†³å®š</span>
</span></span><span class="line"><span class="cl">    <span class="n">t2</span> <span class="o">=</span> <span class="n">MyThread</span><span class="p">(</span><span class="s2">&#34;zjl&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># t.run()  # è¿™ç§æ–¹æ³•æ˜¯è°ƒç”¨æ–¹æ³•ï¼Œä¾ç„¶æ˜¯å•çº¿ç¨‹</span>
</span></span><span class="line"><span class="cl">    <span class="n">t2</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>  <span class="c1"># å¼€å¯çº¿ç¨‹ï¼Œçº¿ç¨‹æ­¤æ—¶å¯ä»¥å¼€å§‹å·¥ä½œï¼Œä½†ä¸å¿…é¡»ï¼Œå…·ä½“æ‰§è¡Œæ—¶é—´ç”±CPUå†³å®š</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># for i in range(1000):</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#     print(&#34;ä¸»çº¿ç¨‹:&#34;, i)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç”±äºä¸»çº¿ç¨‹å’Œå­çº¿ç¨‹åŒæ—¶æ‰§è¡Œï¼Œå…±åŒè¾“å‡ºåœ¨å·¥ä½œå°ï¼Œæ‰€ä»¥ä¼šé€ æˆå›¾ä¸­çš„æƒ…å†µï¼š</p>
<img src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220301112917627.png" alt="image-20220301112917627" style="zoom: 67%;" />
<h3 id="42-å¤šè¿›ç¨‹">4.2 å¤šè¿›ç¨‹</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span> <span class="n">Process</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">func</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;å­è¿›ç¨‹:&#34;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span> <span class="o">=</span> <span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">func</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;ä¸»è¿›ç¨‹:&#34;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220307210355884.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220307210355884.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220307210355884.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220307210355884.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220307210355884.png"
        title="image-20220307210355884" /></p>
<h3 id="43-çº¿ç¨‹æ± è¿›ç¨‹æ± ">4.3 çº¿ç¨‹æ± \è¿›ç¨‹æ± </h3>
<p>çº¿ç¨‹æ± ï¼šä¸€æ¬¡æ€§å¼€è¾Ÿä¸€äº›çº¿ç¨‹ï¼Œç”¨æˆ·ç›´æ¥ç»™çº¿ç¨‹æ± æäº¤ä»»åŠ¡ï¼Œçº¿ç¨‹çš„ä»»åŠ¡è°ƒåº¦äº¤ç»™çº¿ç¨‹æ± å®Œæˆ</p>
<p>åˆ›å»ºçº¿ç¨‹æ± ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">concurrent.futures</span> <span class="kn">import</span> <span class="n">ThreadPoolExecutor</span>
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="k">as</span> <span class="n">t</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">t</span><span class="o">.</span><span class="n">submit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1"># çº¿ç¨‹æ± å¤–çš„å«åšå®ˆæŠ¤ï¼Œéœ€è¦ç­‰å¾…çº¿ç¨‹æ± å†…çš„ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œæ‰èƒ½ç»§ç»­æ‰§è¡Œ</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ol>
<li>å¦‚ä½•æå–å•ä¸ªé¡µé¢ çš„æ•°æ®</li>
<li>åˆ©ç”¨çº¿ç¨‹æ± ï¼Œè¿›è¡Œå¤šä¸ªé¡µé¢åŒæ—¶æŠ“å–</li>
</ol>
<p>åŒ—äº¬æ–°å‘åœ°ä¸¾ä¾‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">csv</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">concurrent.futures</span> <span class="kn">import</span> <span class="n">ThreadPoolExecutor</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;xfd_list.csv&#34;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&#34;w&#34;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&#34;utf-8&#34;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>  <span class="c1"># newline æ˜¯ä¸ºäº†è¿‡æ»¤æ‰æ¢è¡Œç¬¦</span>
</span></span><span class="line"><span class="cl"><span class="n">csv_writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">download_one_page</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">page_num</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;current&#34;</span><span class="p">:</span> <span class="n">page_num</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">html_page_json</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">price_list</span> <span class="o">=</span> <span class="n">html_page_json</span><span class="p">[</span><span class="s1">&#39;list&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">price_list</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># print(item)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># txt = [0 for _ in range(7)]</span>
</span></span><span class="line"><span class="cl">        <span class="n">txt</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="mi">7</span>
</span></span><span class="line"><span class="cl">        <span class="n">txt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;prodName&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">txt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;lowPrice&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">txt</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;highPrice&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">txt</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;avgPrice&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">txt</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;place&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">txt</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;unitInfo&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">txt</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;pubDate&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># txt.append(item[&#39;prodName&#39;])</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># txt.append(item[&#39;lowPrice&#39;])</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># txt.append(item[&#39;highPrice&#39;])</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># txt.append(item[&#39;avgPrice&#39;])</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># txt.append(item[&#39;place&#39;])</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># txt.append(item[&#39;unitInfo&#39;])</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># txt.append(item[&#39;pubDate&#39;])</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># print(info)</span>
</span></span><span class="line"><span class="cl">        <span class="n">csv_writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">page_num</span><span class="p">,</span> <span class="s2">&#34;æå–å®Œæ¯•ï¼ï¼ï¼&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span> 		<span class="c1"># å¼€å¤šäº†æœ‰å¯èƒ½å‡ºæ ¼å¼é—®é¢˜</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">200</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">f</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">download_one_page</span><span class="p">,</span> <span class="s2">&#34;http://www.xinfadi.com.cn/getPriceData.html&#34;</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;å…¨éƒ¨ä¸‹è½½å®Œæ¯•!!!&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># for num in range(1, 200):</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#     download_one_page(&#34;http://www.xinfadi.com.cn/getPriceData.html&#34;, num)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="44-åç¨‹">4.4 åç¨‹</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220308105704198.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220308105704198.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220308105704198.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220308105704198.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220308105704198.png"
        title="image-20220308105704198" /></p>
<p>è¦è¾¾åˆ°å¼‚æ­¥æ•ˆæœï¼Œéœ€è¦å°†åŒæ­¥æ“ä½œå†™ä¸ºåç¨‹æ“ä½œï¼š</p>
<p><strong>ï¼ˆåŒæ­¥æ“ä½œï¼‰</strong></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220308111517512.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220308111517512.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220308111517512.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220308111517512.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220308111517512.png"
        title="image-20220308111517512" /></p>
<p><strong>ï¼ˆå¼‚æ­¥æ“ä½œï¼‰</strong></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220308111848262.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220308111848262.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220308111848262.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220308111848262.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220308111848262.png"
        title="image-20220308111848262" /></p>
<p>pythonä¸å¤ªå¸Œæœ›ä¸Šè¿°å†™æ³•ï¼Œå› ä¸ºä¸»è¿›ç¨‹é‡Œçº¿ç¨‹è¿‡å¤šï¼Œå»ºè®®ä¸‹è¿°å†™æ³•ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># pythonä¸å¸Œæœ›ä¸Šé¢é‚£ç§å†™æ³•ï¼Œå› ä¸ºä¸»è¿›ç¨‹çš„çº¿ç¨‹è¿‡å¤š</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">func1</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;ä½ å¥½ï¼æˆ‘æ˜¯æé›ªç´ï¼&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>     <span class="c1"># å°†å¼‚æ­¥æ“ä½œæŒ‚èµ·</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;ä½ å¥½ï¼æˆ‘æ˜¯æé›ªç´ï¼&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">func2</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;ä½ å¥½ï¼æˆ‘æ˜¯ç‹å»ºå›½ï¼&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>     <span class="c1"># å°†å¼‚æ­¥æ“ä½œæŒ‚èµ·</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;ä½ å¥½ï¼æˆ‘æ˜¯ç‹å»ºå›½ï¼&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">func3</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;ä½ å¥½ï¼æˆ‘æ˜¯é»æ˜ï¼&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>     <span class="c1"># å°†å¼‚æ­¥æ“ä½œæŒ‚èµ·</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;ä½ å¥½ï¼æˆ‘æ˜¯é»æ˜ï¼&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># ç¬¬ä¸€ç§å†™æ³•</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># f1 = func1()</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># await f1  # ä¸€èˆ¬waitæŒ‚èµ·æ“ä½œæ”¾åœ¨åç¨‹å¯¹è±¡å‰é¢</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># ç¬¬äºŒç§å†™æ³•ï¼ˆæ¨èï¼‰</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># ä¸€æ¬¡æ€§å¯åŠ¨å¤šä¸ªä»»åŠ¡ï¼ˆåç¨‹ï¼‰</span>
</span></span><span class="line"><span class="cl">    <span class="n">tasks</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">func1</span><span class="p">()),</span>   <span class="c1"># åˆ›å»ºæˆtaskå¯¹è±¡</span>
</span></span><span class="line"><span class="cl">        <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">func2</span><span class="p">()),</span>
</span></span><span class="line"><span class="cl">        <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">func3</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">tasks</span><span class="p">)</span>   <span class="c1"># æŒ‚èµ·</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="n">t2</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">t2</span> <span class="o">-</span> <span class="n">t1</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ¨¡æ‹Ÿçˆ¬è™«åº”ç”¨ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æ¨¡æ‹Ÿçˆ¬è™«åº”ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">download</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="s2">&#34;å‡†å¤‡å¼€å§‹ä¸‹è½½&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>    <span class="c1"># æ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚  å®é™…ä¸­ åªéœ€åœ¨æ­¤å¤„å°†çˆ¬è™«ç½‘ç»œè¯·æ±‚è¯­å¥å†™ä¸ºåç¨‹å½¢å¼å³å¯</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="s2">&#34;ä¸‹è½½å®Œæ¯•&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">urls</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">tasks</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">urls</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">tasks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">download</span><span class="p">(</span><span class="n">url</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># tasks = [asyncio.create_task(download(url)) for url in urls]   # è¿™æ ·ä¹Ÿå¯ä»¥ æ•ˆæœä¸€æ ·çš„ æ›´åŠ ç®€æ´</span>
</span></span><span class="line"><span class="cl">    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">tasks</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">urls</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;https://www.google.com/webhp&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;https://www.baidu.com/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;https://www.bilibili.com/&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">(</span><span class="n">urls</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="45-aiohttpæ¨¡å—åº”ç”¨">4.5 aiohttpæ¨¡å—åº”ç”¨</h3>
<p>requests.get() åŒæ­¥çš„ä»£ç   &mdash;&gt;  å¼‚æ­¥æ“ä½œaiohttp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">conda</span> <span class="n">install</span> <span class="n">aiohttp</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">aiohttp</span>
</span></span><span class="line"><span class="cl"><span class="c1"># aiohttp.ClientSession()  &lt;==&gt;  requests  å‡ ä¹ä¸€æ¨¡ä¸€æ ·</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">download</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">name</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>                     <span class="c1"># ä»å³è¾¹åˆ‡ç‰‡ï¼Œåˆ‡ä¸€æ¬¡ï¼Œå–ç¬¬äºŒä¸ªå…ƒç´ </span>
</span></span><span class="line"><span class="cl">    <span class="k">async</span> <span class="k">with</span> <span class="n">aiohttp</span><span class="o">.</span><span class="n">ClientSession</span><span class="p">()</span> <span class="k">as</span> <span class="n">Session</span><span class="p">:</span>   <span class="c1"># Sessionç°åœ¨ç›¸å½“äºrequests</span>
</span></span><span class="line"><span class="cl">        <span class="k">async</span> <span class="k">with</span> <span class="n">Session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span> <span class="k">as</span> <span class="n">resp</span><span class="p">:</span>         <span class="c1"># resp = requests.get(url)</span>
</span></span><span class="line"><span class="cl">            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>         <span class="c1"># å½“è¯·æ±‚è¿”å›ï¼Œå°±å¯ä»¥å¼€å§‹å†™å…¥æ–‡ä»¶ æ­¤å¤„å¯ä»¥å»¶ç”³ aiofiles å¼‚æ­¥å†™å…¥æ–‡ä»¶</span>
</span></span><span class="line"><span class="cl">                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="k">await</span> <span class="n">resp</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>   <span class="c1"># è¯»å–å†…å®¹æ˜¯å¼‚æ­¥çš„ï¼Œå› æ­¤éœ€è¦awaitæŒ‚èµ·</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s2">&#34;ä¸‹è½½å®Œæ¯•ï¼&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">urls</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">tasks</span> <span class="o">=</span> <span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">download</span><span class="p">(</span><span class="n">url</span><span class="p">))</span> <span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">urls</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">tasks</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">urls</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;https://img.syt5.com/2021/0907/20210907082121262.jpg&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;https://img.syt5.com/2021/0907/20210907082121629.jpg&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;https://img.syt5.com/2021/0907/20210907082121801.jpg&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># asyncio.run(main(urls))   # ä¼šæŠ¥é”™ï¼ŒRuntimeError: Event loop is closed   æ”¹ä¸ºå¦‚ä¸‹ï¼š</span>
</span></span><span class="line"><span class="cl">    <span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_event_loop</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">loop</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span><span class="n">main</span><span class="p">(</span><span class="n">urls</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="46-æŠ“å–å°è¯´">4.6 æŠ“å–å°è¯´</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">asyncio</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">aiohttp</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">aiofiles</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ‰€éœ€ç½‘å€</span>
</span></span><span class="line"><span class="cl"><span class="c1"># http://dushu.baidu.com/api/pc/getCatalog?data={&#34;book_id&#34;:&#34;4306063500&#34;}  # å°è¯´ç« èŠ‚</span>
</span></span><span class="line"><span class="cl"><span class="c1"># http://dushu.baidu.com/api/pc/getChapterContent?data={&#34;book_id&#34;:&#34;4306063500&#34;,&#34;cid&#34;:&#34;4306063500|1569782244&#34;,&#34;need_bookinfo&#34;:1}  # å°è¯´ç« èŠ‚å†…å®¹</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">get_catalog</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">dict</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">book_id</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="s1">&#39;novel&#39;</span><span class="p">][</span><span class="s1">&#39;book_id&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">tasks</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">dict</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="s1">&#39;novel&#39;</span><span class="p">][</span><span class="s1">&#39;items&#39;</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">        <span class="n">title</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">cid</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;cid&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># æ­¤å¤„å¯ä»¥å¼€å§‹è¿›è¡Œè·å–å°è¯´å†…å®¹</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># å‡†å¤‡å¼‚æ­¥ä»»åŠ¡</span>
</span></span><span class="line"><span class="cl">        <span class="n">tasks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_content</span><span class="p">(</span><span class="n">book_id</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">cid</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># å¼€å§‹æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡</span>
</span></span><span class="line"><span class="cl">    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">tasks</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;ä¸‹è½½å®Œæ¯•ï¼ï¼ï¼&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">get_content</span><span class="p">(</span><span class="n">book_id</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">cid</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;book_id&#34;</span><span class="p">:</span> <span class="n">book_id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;cid&#34;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">book_id</span><span class="si">}</span><span class="s2">|</span><span class="si">{</span><span class="n">cid</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;need_bookinfo&#34;</span><span class="p">:</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;http://dushu.baidu.com/api/pc/getChapterContent?data=</span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">async</span> <span class="k">with</span> <span class="n">aiohttp</span><span class="o">.</span><span class="n">ClientSession</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">async</span> <span class="k">with</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span> <span class="k">as</span> <span class="n">resp</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">dict</span> <span class="o">=</span> <span class="k">await</span> <span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># å¼‚æ­¥å†™å…¥ aiofiles</span>
</span></span><span class="line"><span class="cl">            <span class="k">async</span> <span class="k">with</span> <span class="n">aiofiles</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;è¥¿æ¸¸è®°/&#39;</span> <span class="o">+</span> <span class="n">title</span> <span class="o">+</span> <span class="s1">&#39;.txt&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">await</span> <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">dict</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="s1">&#39;novel&#39;</span><span class="p">][</span><span class="s1">&#39;content&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">book_id</span> <span class="o">=</span> <span class="s1">&#39;4306063500&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://dushu.baidu.com/api/pc/getCatalog?data={&#34;book_id&#34;:&#34;&#39;</span> <span class="o">+</span> <span class="n">book_id</span> <span class="o">+</span> <span class="s1">&#39;&#34;}&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># print(url)</span>
</span></span><span class="line"><span class="cl">    <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">get_catalog</span><span class="p">(</span><span class="n">url</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ–°å»ºæ–‡æ¡£ï¼š</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220308201310098.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220308201310098.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220308201310098.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220308201310098.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220308201310098.png"
        title="image-20220308201310098" /></p>
<h3 id="47-è§†é¢‘æŠ“å–">4.7 è§†é¢‘æŠ“å–</h3>
<p>é¦–å…ˆï¼Œè§†é¢‘ä¸å¯èƒ½ç›´æ¥åŠ è½½åˆ°é¡µé¢ï¼Œå› ä¸ºè¿™æ ·ä¼šå¯¼è‡´ç½‘é¡µé€Ÿåº¦ææ…¢&hellip;&hellip;ä¸å¯èƒ½ä¸€æ¬¡æ€§åŠ è½½å®Œæ¯•ï¼ï¼ï¼</p>
<p>é‚£è§†é¢‘ç½‘ç«™ä¸€èˆ¬æ€ä¹ˆåšå‘¢ï¼Ÿï¼Ÿï¼Ÿ</p>
<p>ç­”ï¼šç”¨æˆ·ä¸Šä¼  &ndash;&gt; è½¬ç ï¼ˆæŠŠè§†é¢‘åšå¤„ç†ï¼Œ2kï¼Œ1080ï¼Œæ ‡æ¸…ï¼‰ &ndash;&gt; åˆ‡ç‰‡å¤„ç†ï¼ˆæŠŠå•ä¸ªçš„æ–‡ä»¶è¿›è¡Œæ‹†åˆ†ï¼‰</p>
<blockquote>
<p>éœ€è¦ä¸€ä¸ªæ–‡ä»¶è®°å½•ï¼š1. è§†é¢‘æ’­æ”¾é¡ºåºï¼Œ2. è§†é¢‘å­˜æ”¾è·¯å¾„ã€‚    M3U8  txt  json    ==&gt;  æ–‡æœ¬</p>
<p>æƒ³è¦æŠ“å–ä¸€ä¸ªè§†é¢‘ï¼š</p>
<ol>
<li>æ‰¾åˆ°m3u8æ–‡ä»¶ï¼ˆå„ç§æ‰‹æ®µï¼‰</li>
<li>é€šè¿‡m3u8ä¸‹è½½åˆ°tsæ–‡ä»¶</li>
<li>å¯ä»¥é€šè¿‡å„ç§æ‰‹æ®µï¼ˆä¸ä»…æ˜¯ç¼–ç¨‹æ‰‹æ®µï¼‰ æŠŠtsæ–‡ä»¶åˆå¹¶ä¸ºä¸€ä¸ªmp4æ–‡ä»¶</li>
</ol>
</blockquote>
<h4 id="471-ç®€å•éš¾åº¦">4.7.1 ç®€å•éš¾åº¦</h4>
<p>æµç¨‹ï¼š</p>
<ol>
<li>é’ˆå¯¹é¡µé¢æºä»£ç ä¸­å«æœ‰m3u8çš„è§†é¢‘ï¼Œé‡‡ç”¨ä»¥ä¸‹æ–¹æ³•æŠ“å–åˆ°m3u8æ–‡ä»¶ï¼š</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://91kju.com/vod-play-id-1039-sid-1-pid-1.html&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;user-agent&#34;</span><span class="p">:</span> <span class="s2">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;origin&#34;</span><span class="p">:</span> <span class="s2">&#34;https://91kju.com&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># obj = re.compile(r&#34;\&#34;url\&#34;:(?P&lt;url&gt;.*?),&#34;, re.S)          # æ³¨æ„ï¼ï¼ï¼è¿™æ ·æå–å‡ºæ¥çš„ç½‘å€æ˜¯å¸¦å¼•å·çš„ï¼å¿…ç„¶æ˜¯æ— æ³•è®¿é—®çš„ï¼Œè¦æå–ä¸å¸¦å¼•å·çš„ç½‘å€ï¼ï¼ï¼</span>
</span></span><span class="line"><span class="cl">    <span class="n">obj</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;</span><span class="se">\&#34;</span><span class="s2">url</span><span class="se">\&#34;</span><span class="s2">:</span><span class="se">\&#34;</span><span class="s2">(?P&lt;url&gt;.*?)</span><span class="se">\&#34;</span><span class="s2">,&#34;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">S</span><span class="p">)</span>        <span class="c1"># æ­¤å¤„ä¸€å®šè¦æ³¨æ„ï¼ï¼ï¼</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># print(resp.text)</span>
</span></span><span class="line"><span class="cl">    <span class="n">m3u8_url</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;url&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># print(m3u8_url)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># ä¸‹è½½m3u8æ–‡ä»¶</span>
</span></span><span class="line"><span class="cl">    <span class="n">path</span> <span class="o">=</span> <span class="n">m3u8_url</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">resp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;user-agent&#34;</span><span class="p">:</span> <span class="s2">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;origin&#34;</span><span class="p">:</span> <span class="s2">&#34;https://91kju.com&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;path&#34;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&#34;/</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;authority&#34;</span><span class="p">:</span> <span class="s2">&#34;m3api.awenhao.com&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">resp2</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">m3u8_url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;ç«æ˜Ÿæ•‘æ´.m3u8&#34;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">resp2</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;m3u8ä¸‹è½½å®Œæ¯•ï¼&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">resp2</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ol start="2">
<li>
<p>æ‹¿åˆ°m3u8æ–‡ä»¶åæ‰å¯ä»¥å¼€å§‹ä¸‹è½½è§†é¢‘</p>
<p>å›¾ä¸­çº¢æ¡†ç¤ºä¾‹éƒ¨åˆ†å°±æ˜¯è§†é¢‘èµ„æºçš„é“¾æ¥ï¼Œå¯ä»¥ä»å…¶ä¸­ä¸‹è½½è§†é¢‘ç‰‡æ®µ</p>
</li>
</ol>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220309100436560.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220309100436560.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220309100436560.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220309100436560.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220309100436560.png"
        title="image-20220309100436560" /></p>
<ol start="3">
<li>ä¸‹è½½è§†é¢‘ç‰‡æ®µ</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># æ‹¿åˆ°m3u8åï¼Œå°±å¯ä»¥å¼€å§‹ä¸‹è½½è§†é¢‘äº†</span>
</span></span><span class="line"><span class="cl"><span class="n">num</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;ç«æ˜Ÿæ•‘æ´.m3u8&#34;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>     <span class="c1"># å»æ‰ç©ºæ ¼ï¼Œç©ºç™½ï¼Œæ¢è¡Œç¬¦</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">):</span>    <span class="c1"># è‹¥è¡Œå¼€å¤´ä¸º # , ä¸è¦</span>
</span></span><span class="line"><span class="cl">            <span class="k">continue</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># print(line)</span>
</span></span><span class="line"><span class="cl">        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;video/</span><span class="si">{</span><span class="n">num</span><span class="si">}</span><span class="s2">.mp4&#34;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">resp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">num</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;ç‰‡æ®µ</span><span class="si">{</span><span class="n">num</span><span class="si">}</span><span class="s2">ä¸‹è½½å®Œæ¯•ï¼ï¼ï¼&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220309102034963.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220309102034963.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220309102034963.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220309102034963.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220309102034963.png"
        title="image-20220309102034963" /></p>
<ol start="4">
<li>æœ€åéœ€è¦è½¯ä»¶å°†è§†é¢‘ç‰‡æ®µåˆæˆä¸ºå®Œæ•´çš„è§†é¢‘</li>
</ol>
<h4 id="472-å¤æ‚91">4.7.2 å¤æ‚91</h4>
<p>æ€è·¯ï¼š</p>
<ol>
<li>æ‹¿åˆ°ä¸»é¡µé¢çš„é¡µé¢æºä»£ç ï¼Œæ‰¾åˆ°iframe</li>
<li>ä»iframeçš„é¡µé¢æºä»£ç ä¸­æ‹¿åˆ°m3u8æ–‡ä»¶</li>
<li>ä¸‹è½½ç¬¬ä¸€å±‚m3u8æ–‡ä»¶ &ndash;&gt; ä¸‹è½½ç¬¬äºŒå±‚m3u8æ–‡ä»¶ï¼ˆè§†é¢‘å­˜æ”¾è·¯å¾„ï¼‰</li>
<li>ä¸‹è½½è§†é¢‘</li>
<li>ä¸‹è½½å¯†é’¥ï¼Œè¿›è¡Œè§£å¯†æ“ä½œ</li>
<li>å°†ç‰‡æ®µåˆæˆè§†é¢‘</li>
</ol>
<p>æš‚æœªå®æ–½</p>
<p>å¼‚æ­¥ä¸‹è½½è§†é¢‘ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_m3u8</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">page_code</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="n">text</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># print(resp.text)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># å–m3u8çš„url</span>
</span></span><span class="line"><span class="cl">    <span class="n">obj</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;&#34;url&#34;:&#34;(?P&lt;m3u8_url&gt;.*?)&#34;,&#34;&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">S</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">m3u8_url</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">page_code</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;m3u8_url&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># print(m3u8_url)</span>
</span></span><span class="line"><span class="cl">    <span class="n">m3u8</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">m3u8_url</span><span class="p">)</span><span class="o">.</span><span class="n">content</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># print(m3u8)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># å–title</span>
</span></span><span class="line"><span class="cl">    <span class="n">page_bs</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">page_code</span><span class="p">,</span> <span class="s2">&#34;html.parser&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">obj</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;ã€Š(?P&lt;title&gt;.*?)ã€‹&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">S</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">title</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">page_bs</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># print(title.text)</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s1">.m3u8&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">m3u8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s1">.m3u8 ä¸‹è½½å®Œæ¯•ï¼&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s1">.m3u8&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># æ‹¿åˆ°m3u8åï¼Œå°±å¯ä»¥å¼€å§‹ä¸‹è½½è§†é¢‘äº† å¼‚æ­¥</span>
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">dowaload</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">session</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">async</span> <span class="k">with</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span> <span class="k">as</span> <span class="n">resp</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">async</span> <span class="k">with</span> <span class="n">aiofiles</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;video/</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">await</span> <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="k">await</span> <span class="n">resp</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>        <span class="c1"># å¼‚æ­¥æŠŠä¸‹è½½çš„è§†é¢‘ç‰‡æ®µå†™å…¥æ–‡ä»¶</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">ä¸‹è½½å®Œæ¯•ï¼&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">aio_download</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">tasks</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">m3u8</span><span class="o">=</span> <span class="n">get_m3u8</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># åœ¨æ­¤å¤„åˆ›å»ºsessionæ¯”åœ¨downloadé‡Œé¢åˆ›å»ºsessionå¥½ï¼Œå› ä¸ºåªéœ€è¦åˆ›å»ºä¸€æ¬¡ï¼Œè‹¥æ˜¯åœ¨downloadä¸­åˆ›å»ºsessionï¼Œåˆ™æ¯ä¸ªäººç‰©éƒ½éœ€è¦é‡æ–°åˆ›å»ºsession</span>
</span></span><span class="line"><span class="cl">    <span class="k">async</span> <span class="k">with</span> <span class="n">aiohttp</span><span class="o">.</span><span class="n">ClientSession</span><span class="p">()</span> <span class="k">as</span> <span class="n">Session</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># async with aiofiles.open(m3u8, mode=&#39;r&#39;, encoding=&#39;utf-8&#39;) as f:</span>
</span></span><span class="line"><span class="cl">        <span class="k">async</span> <span class="k">with</span> <span class="n">aiofiles</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">m3u8</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># ä¸ºäº†å¼‚æ­¥ä¹Ÿå¯ä»¥æŒ‰é¡ºåºæ’åˆ—è§†é¢‘ç‰‡æ®µï¼Œå¯ä»¥ä½¿ç”¨ç‰‡æ®µæ‰€åœ¨çš„è¡Œå·è¿›è¡Œå‘½å</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># for num, line in enumerate(f, 1):</span>
</span></span><span class="line"><span class="cl">            <span class="k">async</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                    <span class="k">continue</span>
</span></span><span class="line"><span class="cl">                <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="c1"># print(line)</span>
</span></span><span class="line"><span class="cl">                    <span class="n">num</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                    <span class="c1"># print(num)</span>
</span></span><span class="line"><span class="cl">                    <span class="n">name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">num</span><span class="si">}</span><span class="s1">.mp4&#39;</span>
</span></span><span class="line"><span class="cl">                    <span class="c1"># print(name, line)</span>
</span></span><span class="line"><span class="cl">                    <span class="n">task</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">dowaload</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">Session</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                    <span class="n">tasks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">task</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">tasks</span><span class="p">)</span>       <span class="c1"># æ­¤å¤„ä¸èƒ½å¾€å‰æ‹‰ï¼Œåªèƒ½å†™åœ¨forå¾ªç¯å</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">ä¸‹è½½å®Œæ¯•ï¼ï¼ï¼&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://91kju.com/vod-play-id-61412-sid-1-pid-1.html&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># # get_m3u8(url)</span>
</span></span><span class="line"><span class="cl">    <span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_event_loop</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">loop</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span><span class="n">aio_download</span><span class="p">(</span><span class="n">url</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;æå®šï¼&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä½†å…¶å®è¿™ä¸ªæ–¹æ¡ˆæ— æ³•æŒ‰ç…§ç‰‡æ®µé¡ºåºä¸‹è½½ï¼Œæ‰€ä»¥å¯ä»¥å¾—åˆ°è¡Œå·ä»¥ä¾¿è¿›è¡Œæ’åºï¼Œå¹¶ä¸”ï¼ï¼ï¼è¡Œ38å’Œ41æ ¹æœ¬ä¸ç”¨å¼‚æ­¥å§ï¼Ÿï¼Ÿï¼Ÿæ•ˆæœæ ¹æœ¬æ²¡æœ‰å·®åˆ«ï¼ï¼ï¼å¯ä»¥ç”¨ä»¥ä¸‹å‡½æ•°è¿›è¡Œä¸‹è½½ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">aio_download</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">tasks</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">m3u8</span><span class="o">=</span> <span class="n">get_m3u8</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># åœ¨æ­¤å¤„åˆ›å»ºsessionæ¯”åœ¨downloadé‡Œé¢åˆ›å»ºsessionå¥½ï¼Œå› ä¸ºåªéœ€è¦åˆ›å»ºä¸€æ¬¡ï¼Œè‹¥æ˜¯åœ¨downloadä¸­åˆ›å»ºsessionï¼Œåˆ™æ¯ä¸ªäººç‰©éƒ½éœ€è¦é‡æ–°åˆ›å»ºsession</span>
</span></span><span class="line"><span class="cl">    <span class="k">async</span> <span class="k">with</span> <span class="n">aiohttp</span><span class="o">.</span><span class="n">ClientSession</span><span class="p">()</span> <span class="k">as</span> <span class="n">Session</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># async with aiofiles.open(m3u8, mode=&#39;r&#39;, encoding=&#39;utf-8&#39;) as f:</span>
</span></span><span class="line"><span class="cl">        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">m3u8</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># ä¸ºäº†å¼‚æ­¥ä¹Ÿå¯ä»¥æŒ‰é¡ºåºæ’åˆ—è§†é¢‘ç‰‡æ®µï¼Œå¯ä»¥ä½¿ç”¨ç‰‡æ®µæ‰€åœ¨çš„è¡Œå·è¿›è¡Œå‘½å</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">num</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                    <span class="k">continue</span>
</span></span><span class="line"><span class="cl">                <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="c1"># print(num, line)</span>
</span></span><span class="line"><span class="cl">                    <span class="n">name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">num</span><span class="si">}</span><span class="s1">.mp4&#39;</span>
</span></span><span class="line"><span class="cl">                    <span class="c1"># print(name, line)</span>
</span></span><span class="line"><span class="cl">                    <span class="n">task</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">dowaload</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">Session</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                    <span class="n">tasks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">task</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">tasks</span><span class="p">)</span>       <span class="c1"># æ­¤å¤„ä¸èƒ½å¾€å‰æ‹‰ï¼Œåªèƒ½å†™åœ¨forå¾ªç¯å</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">ä¸‹è½½å®Œæ¯•ï¼ï¼ï¼&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="äº”selenium">äº”ã€selenium</h2>
<h3 id="51-æ¦‚è¿°">5.1 æ¦‚è¿°</h3>
<p>é—®é¢˜ï¼š</p>
<blockquote>
<p>èƒ½ä¸èƒ½è®©æˆ‘çš„ç¨‹åºè¿æ¥åˆ°æµè§ˆå™¨ï¼Œè®©æµè§ˆå™¨é‡Œæ¥å®Œæˆå„ç§å¤æ‚çš„æ“ä½œï¼Œæˆ‘ä»¬åªéœ€è¦æ¥å—æœ€åçš„ç»“æœ</p>
</blockquote>
<p>seleniumï¼š</p>
<blockquote>
<p>è‡ªåŠ¨åŒ–æµ‹è¯•å·¥å…·ï¼Œå¯ä»¥æ‰“å¼€æµè§ˆå™¨ï¼Œç„¶ååƒäººä¸€æ ·å»æ“ä½œæµè§ˆå™¨ï¼Œæˆ‘ä»¬å¯ä»¥ä»seleniumä¸­ç›´æ¥æå–ç½‘é¡µä¸Šçš„å„ç§ä¿¡æ¯</p>
</blockquote>
<p>ç¯å¢ƒæ­å»ºï¼š</p>
<blockquote>
<p>conda install selenium</p>
<p>ä¸‹è½½æµè§ˆå™¨é©±åŠ¨ï¼šhttps://chromedriver.storage.googleapis.com/index.html</p>
<p>â€‹		æŠŠè§£å‹ç¼©çš„æµè§ˆå™¨é©±åŠ¨ chromedriver æ”¾åœ¨pythonè§£é‡Šå™¨æ‰€åœ¨çš„æ–‡ä»¶å¤¹</p>
<p>è®©seleniumå¯åŠ¨è°·æ­Œæµè§ˆå™¨ï¼ï¼ï¼</p>
</blockquote>
<p>æŸ¥æ‰¾æµè§ˆå™¨çš„ç‰ˆæœ¬å·ï¼š</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220309212406908.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220309212406908.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220309212406908.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220309212406908.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220309212406908.png"
        title="image-20220309212406908" /></p>
<p>å»ç»™çš„ç½‘ç«™é‡Œæ‰¾å¯¹åº”çš„ç‰ˆæœ¬å·ï¼š</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220309212520333.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220309212520333.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220309212520333.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220309212520333.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220309212520333.png"
        title="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220309212520333.png" /></p>
<p>æŠŠè§£å‹ç¼©çš„æµè§ˆå™¨é©±åŠ¨ chromedriver æ”¾åœ¨pythonè§£é‡Šå™¨æ‰€åœ¨çš„æ–‡ä»¶å¤¹ï¼Œpythonè§£é‡Šå™¨çš„è·¯å¾„å¦‚ä¸‹ï¼š</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220309212800807.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220309212800807.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220309212800807.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220309212800807.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220309212800807.png"
        title="image-20220309212800807" /></p>
<p>ç²˜è´´è¿›å»ï¼š</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220309213028236.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220309213028236.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220309213028236.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220309213028236.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220309213028236.png"
        title="image-20220309213028236" /></p>
<p>è®©seleniumå¯åŠ¨æµè§ˆå™¨ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">selenium.webdriver</span> <span class="kn">import</span> <span class="n">Chrome</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 1. åˆ›å»ºæµè§ˆå™¨å¯¹è±¡</span>
</span></span><span class="line"><span class="cl"><span class="n">web</span> <span class="o">=</span> <span class="n">Chrome</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 2. æ‰“å¼€ä¸€ä¸ªç½‘å€</span>
</span></span><span class="line"><span class="cl"><span class="n">web</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;https://www.baidu.com&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220309213524995.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220309213524995.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220309213524995.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220309213524995.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220309213524995.png"
        title="image-20220309213524995" /></p>
<p>æ¡ˆä¾‹ï¼ŒæŠ“å–æ‹‰å‹¾ç½‘ä¿¡æ¯ï¼š</p>
<p>è¦æ³¨æ„çš„æ˜¯ï¼ï¼ï¼ä¸€å®šè¦åŠ ç­‰å¾…æ—¶é—´ï¼Œå¦åˆ™æœ‰å¯èƒ½å‘ç”Ÿ æœªåŠ è½½å®Œå°±ç‚¹å‡»ï¼ˆæˆ–è€…æ‹‰å–ä¿¡æ¯ï¼‰å¯¼è‡´å¤±è´¥ï¼ˆæˆ–ä¿¡æ¯ä¸å…¨ï¼‰ï¼ï¼ï¼</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">web</span><span class="o">.</span><span class="n">implicitly_wait</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>  <span class="c1"># ï¼ˆæ™ºèƒ½ï¼‰éšå¼ç­‰å¾…ï¼Œ5ç§’å†…åŠ è½½å®Œå°±ç›´æ¥æ‰§è¡Œä¸‹ä¸€æ¡æŒ‡ä»¤ï¼Œè‹¥è¶…è¿‡5ç§’ï¼ŒæŠ¥é”™</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># WebDriverWait(ä½ çš„chrome()å¯¹è±¡, maxWaitTime(s), checkInterval(s))</span>
</span></span><span class="line"><span class="cl"><span class="c1"># åé¢çš„ .untilçš„æ„æ€æ˜¯ ç›´åˆ°æ‹¬å·å†…çš„lambdaè¡¨è¾¾å¼æˆç«‹ï¼Œä¾‹å¦‚æ­¤å¤„lambdaçš„æ„æ€å°±æ˜¯ï¼šåŠ è½½å‡ºnameä¸º&#39;DZ_JSDTCJTW&#39;çš„elementã€‚</span>
</span></span><span class="line"><span class="cl"><span class="c1"># æ•´è¡Œå®Œæ•´æ„æ€å°±æ˜¯ï¼šæ¯è¿‡0.2så°±æ£€æŸ¥ä¸€ä¸‹æ˜¯å¦åŠ è½½å‡ºåä¸º&#39;DZ_JSDTCJTW&#39;çš„å…ƒç´ ï¼Œè‹¥åŠ è½½å‡ºï¼Œå°±æ‰§è¡Œä¸‹ä¸€è¡Œï¼Œè‹¥è¿˜æ— ï¼Œæœ€é•¿ç­‰å¾…10sã€‚</span>
</span></span><span class="line"><span class="cl"><span class="n">WebDriverWait</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">find_element_by_name</span><span class="p">(</span><span class="s1">&#39;DZ_JSDTCJTW&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_name</span><span class="p">(</span><span class="s1">&#39;DZ_JSDTCJTW&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_temp</span><span class="p">())</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">selenium.webdriver</span> <span class="kn">import</span> <span class="n">Chrome</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">selenium.webdriver.common.keys</span> <span class="kn">import</span> <span class="n">Keys</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">web</span> <span class="o">=</span> <span class="n">Chrome</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">web</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;https://lagou.com&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ‰¾åˆ°æŸä¸ªå…ƒç´ ï¼Œç‚¹å‡»å®ƒ</span>
</span></span><span class="line"><span class="cl"><span class="n">el</span> <span class="o">=</span> <span class="n">web</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s1">&#39;//*[@id=&#34;changeCityBox&#34;]/p[1]/a&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">el</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>   <span class="c1"># ç‚¹å‡»äº‹ä»¶</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">web</span><span class="o">.</span><span class="n">implicitly_wait</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>  <span class="c1"># ï¼ˆæ™ºèƒ½ï¼‰éšå¼ç­‰å¾…ï¼Œ5ç§’å†…åŠ è½½å®Œå°±ç›´æ¥æ‰§è¡Œä¸‹ä¸€æ¡æŒ‡ä»¤ï¼Œè‹¥è¶…è¿‡5ç§’ï¼ŒæŠ¥é”™</span>
</span></span><span class="line"><span class="cl"><span class="c1"># åœ¨æœç´¢æ¡†ä¸­ æœç´¢python</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">el</span> <span class="o">=</span> <span class="n">web</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s1">&#39;//*[@id=&#34;search_input&#34;]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&#34;python&#34;</span><span class="p">,</span> <span class="n">Keys</span><span class="o">.</span><span class="n">ENTER</span><span class="p">)</span>   <span class="c1"># æ‰¾åˆ°è¾“å…¥æ¡†  è¾“å…¥pythonå¹¶å›è½¦</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">web</span><span class="o">.</span><span class="n">implicitly_wait</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>     <span class="c1"># é˜²æ­¢æœªåŠ è½½å®Œï¼Œå¯¼è‡´è¾“å‡ºä¸å…¨   *****å¾ˆé‡è¦ï¼ï¼ï¼</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ‰¾åˆ°ä¿¡æ¯æ‰€åœ¨ä½ç½®  elements æ˜¯æ‰¾åˆ°æ‰€æœ‰çš„</span>
</span></span><span class="line"><span class="cl"><span class="n">job_list</span> <span class="o">=</span> <span class="n">web</span><span class="o">.</span><span class="n">find_elements_by_xpath</span><span class="p">(</span><span class="s1">&#39;//*[@id=&#34;jobList&#34;]/div[1]/div&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">job_list</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># job_name = item.find_element_by_tag_name(&#34;a&#34;).text    # æŸ¥æ‰¾ itemä¸­ aæ ‡ç­¾çš„å€¼</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># print(job_name)</span>
</span></span><span class="line"><span class="cl">    <span class="n">job_name</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s1">&#39;./div/div/div/a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
</span></span><span class="line"><span class="cl">    <span class="n">job_price</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s1">&#39;./div/div/div[2]/span&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>      <span class="c1"># ./ ç›¸å¯¹è·¯å¾„</span>
</span></span><span class="line"><span class="cl">    <span class="n">job_company</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s1">&#39;./div/div[2]/div/a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">job_name</span><span class="p">,</span> <span class="n">job_price</span><span class="p">,</span> <span class="n">job_company</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è·å–æ ‡ç­¾å†…å…ƒç´ çš„å€¼ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">detail1</span> <span class="o">=</span> <span class="n">web</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s1">&#39;//*[@id=&#34;zpid_19506994&#34;]/div[2]/a&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">detail1</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">),</span> <span class="n">detail1</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;class&#39;</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="52-çª—å£åˆ‡æ¢">5.2 çª—å£åˆ‡æ¢</h3>
<p>å¦‚ä½•è¿›å…¥åˆ°æ–°çª—å£ä¸­è¿›è¡Œæå–</p>
<p>æ³¨æ„ï¼šåœ¨seleniumçœ¼ä¸­ï¼Œæ–°çª—å£é»˜è®¤æ˜¯ä¸åˆ‡æ¢è¿‡æ¥çš„</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">web</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">window</span><span class="p">(</span><span class="n">web</span><span class="o">.</span><span class="n">window_handles</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>		<span class="c1"># -1ä»£è¡¨æœ€åä¸€ä¸ªçª—å£ï¼ˆä»å³å¾€å·¦ï¼‰ ä¹Ÿå¯ä»¥åˆ‡æ¢åˆ°å…¶ä»–çª—å£ï¼</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="53-æ— å¤´æµè§ˆå™¨">5.3 æ— å¤´æµè§ˆå™¨</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">selenium.webdriver.chrome.options</span> <span class="kn">import</span> <span class="n">Options</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">opt</span> <span class="o">=</span> <span class="n">Options</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">opt</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&#34;--headless&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">opt</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&#34;--disable-gpu&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">web</span> <span class="o">=</span> <span class="n">Chrome</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="n">opt</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="54-éªŒè¯ç è¯†åˆ«">5.4 éªŒè¯ç è¯†åˆ«</h3>
<p>**è¶…çº§é¹°ï¼**æˆ– <strong>ddddocr</strong></p>
<p>å“ªé‡Œç”¨å°±å¾€å“ªé‡Œæ¬ï¼</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="mf">1.</span> <span class="n">chaojiying</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ç”¨æˆ·ä¸­å¿ƒ&gt;&gt;è½¯ä»¶ID ç”Ÿæˆä¸€ä¸ªæ›¿æ¢ 96001</span>
</span></span><span class="line"><span class="cl"><span class="n">chaojiying</span> <span class="o">=</span> <span class="n">Chaojiying_Client</span><span class="p">(</span><span class="s1">&#39;15237174980&#39;</span><span class="p">,</span> <span class="s1">&#39;12345678&#39;</span><span class="p">,</span> <span class="s1">&#39;930009&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># æœ¬åœ°å›¾ç‰‡æ–‡ä»¶è·¯å¾„ æ¥æ›¿æ¢ a.jpg æœ‰æ—¶WINç³»ç»Ÿé¡»è¦//</span>
</span></span><span class="line"><span class="cl"><span class="n">im</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;a.jpg&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>     <span class="c1"># imå°±æ˜¯å›¾ç‰‡çš„æ‰€æœ‰å­—èŠ‚</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 1902 éªŒè¯ç ç±»å‹  å®˜æ–¹ç½‘ç«™&gt;&gt;ä»·æ ¼ä½“ç³» 3.4+ç‰ˆ print åè¦åŠ ()</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">chaojiying</span><span class="o">.</span><span class="n">PostPic</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="mi">1902</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">2.</span> <span class="n">ddddocr</span>	<span class="n">pip</span> <span class="n">install</span> <span class="n">ddddocr</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">identifyCode</span><span class="p">(</span><span class="n">imgPath</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">ocr</span> <span class="o">=</span> <span class="n">ddddocr</span><span class="o">.</span><span class="n">DdddOcr</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">img</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">imgPath</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">ocr</span><span class="o">.</span><span class="n">classification</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ä¸Šè¿°æ˜¯è¯»å–å›¾ç‰‡è·¯å¾„çš„æ–¹å¼ï¼Œç»“åˆseleniumä¹Ÿå¯ä»¥</span>
</span></span><span class="line"><span class="cl"><span class="n">img</span> <span class="o">=</span> <span class="n">web</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s1">&#39;å›¾ç‰‡çš„xpath&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">screenshot_as_png</span>
</span></span><span class="line"><span class="cl"><span class="n">ocr</span><span class="o">.</span><span class="n">classification</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="55-é˜²æ­¢è‡ªåŠ¨åŒ–è¢«å±è”½">5.5 é˜²æ­¢è‡ªåŠ¨åŒ–è¢«å±è”½</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220311103544489.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220311103544489.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220311103544489.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220311103544489.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220311103544489.png"
        title="image-20220311103544489" /></p>
<p>è¿™æ ·æœ‰æ—¶ä¼šè¢«å±è”½æ‰ï¼ï¼ï¼</p>
<p>è§£å†³æ–¹æ³•ï¼å…¶å®å’Œæ— å¤´æµè§ˆå™¨å¾ˆç›¸ä¼¼ï¼ï¼ï¼</p>
<p>Chromeç‰ˆæœ¬å·å¤§äº88æ—¶ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">selenium.webdriver.chrome.options</span> <span class="kn">import</span> <span class="n">Options</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">opt</span> <span class="o">=</span> <span class="n">Options</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">opt</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--disable-blink-features=AutomationControlled&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">web</span> <span class="o">=</span> <span class="n">Chrome</span><span class="p">(</span><span class="n">option</span><span class="o">=</span><span class="n">opt</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220311104253546.png"
        data-srcset="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220311104253546.png, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220311104253546.png 1.5x, https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220311104253546.png 2x"
        data-sizes="auto"
        alt="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220311104253546.png"
        title="image-20220311104253546" /></p>
<h2 id="å…­jsé€†å‘">å…­ã€Jsé€†å‘</h2>
<p>æœ¬åœ°è¿è¡ŒJSï¼Œå¾—åˆ°å’Œæµè§ˆå™¨ä¸€æ ·çš„åŠ å¯†æ•°æ®ï¼Œå‘é€ç»™æœåŠ¡å™¨</p>
<h3 id="61-æ–­ç‚¹">6.1 æ–­ç‚¹</h3>
<p>ç½‘ç«™ä»£ç è¿è¡Œçš„æ—¶é—´è½´ï¼š</p>
<p>åŠ è½½html-&gt;åŠ è½½js-&gt;è¿è¡Œjsåˆå§‹åŒ–-&gt;ç”¨æˆ·è§¦å‘æŸä¸ªäº‹ä»¶-&gt;è°ƒç”¨äº†æŸæ®µjs-&gt;åŠ å¯†å‡½æ•°-&gt;ç»™æœåŠ¡å™¨å‘é€ä¿¡æ¯ï¼ˆXHR-&gt;SENDï¼‰-&gt; æ¥å—åˆ°æœåŠ¡å™¨çš„æ•°æ®-&gt; è§£å¯†å‡½æ•°-&gt;åˆ·æ–°ç½‘é¡µæ¸²æŸ“</p>
<p>åˆ†ç±»ï¼š</p>
<blockquote>
<p>DOMæ–­ç‚¹ï¼šå½“æ¸²æŸ“çš„æ—¶å€™ï¼ˆæ ·å­å‘ç”Ÿæ”¹å˜çš„æ—¶å€™ï¼‰ï¼Œæ‰æœ‰ç”¨ï¼›åœ¨åŠ å¯†è¿‡ç¨‹ä¸­ï¼Œå…¶å®æ˜¯æ¯”è¾ƒé å‰çš„æ‰§è¡Œæ­¥éª¤ï¼Œè·ç¦»åŠ å¯†å‡½æ•°æ¯”è¾ƒè¿œï¼Œæ— æ³•æ ¹æ®æ ˆå»å¿«é€Ÿå®šä½ï¼Œä¸å¤ªæ¨èç”¨DOMæ–­ç‚¹</p>
<p>DOMäº‹ä»¶æ–­ç‚¹ï¼šå’ŒDOMç±»ä¼¼ï¼Œå¦‚æœä¸èƒ½ç”¨DOMä¸‹æ–­ï¼Œåˆ™è€ƒè™‘ç”¨DOMäº‹ä»¶</p>
<p>XHRæ–­ç‚¹ï¼šæ‰§è¡Œçš„æ¯”è¾ƒé åï¼Œè·ç¦»åŠ å¯†å‡½æ•°æ¯”è¾ƒè¿‘ï¼Œå¯ä»¥æ ¹æ®æ ˆå¿«é€Ÿå®šä½ï¼ŒéXHRå‘é€çš„å°±æ— æ³•æ–­ä½</p>
<p>ä»£ç è¡Œæ–­ç‚¹</p>
<p>ä»£ç çš„æ–­ç‚¹  debugger</p>
<p>å…¨å±€äº‹ä»¶æ–­ç‚¹ï¼ˆæµè§ˆå™¨äº‹ä»¶æ–­ç‚¹ï¼‰</p>
<p>å¼‚å¸¸æ•è·æ–­ç‚¹</p>
</blockquote>
<h2 id="ä¸ƒscrapyæ¡†æ¶">ä¸ƒã€Scrapyæ¡†æ¶</h2>
<p>æ¡†æ¶å°±æ˜¯é›†æˆäº†å¾ˆå¤šåŠŸèƒ½å¹¶ä¸”å…·æœ‰å¾ˆå¼ºé€šç”¨æ€§çš„ä¸€ä¸ªé¡¹ç›®æ¨¡æ¿ï¼Œå­¦ä¹ æ¡†æ¶å°è£…çš„å„ç§åŠŸèƒ½çš„è¯¦ç»†ç”¨æ³•ã€‚</p>
<p>Scrapyæ˜¯çˆ¬è™«ä¸­å°è£…å¥½çš„ä¸€ä¸ªæ˜æ˜Ÿæ¡†æ¶ï¼ŒåŠŸèƒ½ï¼šé«˜æ€§èƒ½çš„æŒä¹…åŒ–å­˜å‚¨ï¼Œå¼‚æ­¥æ•°æ®ä¸‹è½½ï¼Œé«˜æ€§èƒ½çš„æ•°æ®è§£æï¼Œåˆ†å¸ƒå¼</p>
<p>åŸºæœ¬ä½¿ç”¨ï¼š</p>
<ol>
<li>å®‰è£…ç¯å¢ƒï¼š</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">conda</span> <span class="n">install</span> <span class="n">wheel</span>
</span></span><span class="line"><span class="cl"><span class="n">ä¸‹è½½twisted</span><span class="err">ï¼Œ</span><span class="n">ä¸‹è½½åœ°å€ä¸º</span><span class="err">ï¼š</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">lfd</span><span class="o">.</span><span class="n">uci</span><span class="o">.</span><span class="n">edu</span><span class="o">/~</span><span class="n">gohlke</span><span class="o">/</span><span class="n">pythonlibs</span><span class="o">/</span><span class="c1">#twisted</span>
</span></span><span class="line"><span class="cl"><span class="n">å®‰è£…twisted</span><span class="err">ï¼š</span><span class="n">conda</span> <span class="n">install</span> <span class="n">Twisted</span><span class="o">-...</span>
</span></span><span class="line"><span class="cl"><span class="n">conda</span> <span class="n">install</span> <span class="n">pywin32</span>
</span></span><span class="line"><span class="cl"><span class="n">conda</span> <span class="n">install</span> <span class="n">scrapy</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>pythonç”Ÿæˆexeæ–‡ä»¶</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">Pyinstaller -F setup.py æ‰“åŒ…exe
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Pyinstaller -F -w setup.py ä¸å¸¦æ§åˆ¶å°çš„æ‰“åŒ…
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Pyinstaller -F -i xx.ico setup.py æ‰“åŒ…æŒ‡å®šexeå›¾æ ‡æ‰“åŒ…
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>git bash ä½¿ç”¨condaåˆ‡æ¢ç¯å¢ƒ</strong></p>
<ol>
<li>
<p>å°†<a href="https://so.csdn.net/so/search?q=anaconda&amp;spm=1001.2101.3001.7020" target="_blank" rel="noopener noreffer ">anaconda</a>çš„å›¾ç¤ºçš„å‡ ä¸ªè·¯å¾„æ·»åŠ è¿›å»</p>
<img src="https://chuyu-typora.oss-cn-hangzhou.aliyuncs.com/image/image-20220511145649670.png" alt="image-20220511145649670" style="zoom:50%;" />
</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">åˆ›å»ºç¯å¢ƒ
</span></span><span class="line"><span class="cl">conda create -n your_env_name <span class="nv">python</span><span class="o">=</span>3.7
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">åˆ é™¤ç¯å¢ƒ
</span></span><span class="line"><span class="cl">conda remove -n your_env_name --all
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">æ¿€æ´»è‡ªå®šä¹‰çš„ç¯å¢ƒ
</span></span><span class="line"><span class="cl"><span class="nb">source</span> activate your_env_name
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">é€€å‡ºç¯å¢ƒ
</span></span><span class="line"><span class="cl"><span class="nb">source</span> deactivate
</span></span><span class="line"><span class="cl">conda deactivate//æˆ–è€…è¿™æ ·
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">åˆ—å‡ºæ‰€æœ‰çš„ç¯å¢ƒ
</span></span><span class="line"><span class="cl">conda env list
</span></span><span class="line"><span class="cl">conda info --envs//æˆ–è€…è¿™æ ·
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">condaå®‰è£…åŒ…å’Œå¸è½½åŒ…
</span></span><span class="line"><span class="cl">conda install x //å®‰è£…xåŒ…
</span></span><span class="line"><span class="cl">conda uninstall x //å¸è½½xåŒ…
</span></span></code></pre></td></tr></table>
</div>
</div></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2023-07-18</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/%E7%88%AC%E8%99%AB/index.md" target="_blank">Read Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://blog.seucy.me/%E7%88%AC%E8%99%AB/" data-title="çˆ¬è™«" data-hashtags="è®¡ç®—æœºåŸºç¡€,çˆ¬è™«,python"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://blog.seucy.me/%E7%88%AC%E8%99%AB/" data-hashtag="è®¡ç®—æœºåŸºç¡€"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="https://blog.seucy.me/%E7%88%AC%E8%99%AB/" data-title="çˆ¬è™«"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="https://blog.seucy.me/%E7%88%AC%E8%99%AB/" data-title="çˆ¬è™«"><i data-svg-src="/lib/simple-icons/icons/line.min.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on å¾®åš" data-sharer="weibo" data-url="https://blog.seucy.me/%E7%88%AC%E8%99%AB/" data-title="çˆ¬è™«"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/">è®¡ç®—æœºåŸºç¡€</a>,&nbsp;<a href="/tags/%E7%88%AC%E8%99%AB/">çˆ¬è™«</a>,&nbsp;<a href="/tags/python/">python</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav">
            <a href="/go%E5%9F%BA%E7%A1%80%E6%93%8D%E4%BD%9C/" class="next" rel="next" title="Goæµ…æ-åŸºç¡€æ“ä½œ">Goæµ…æ-åŸºç¡€æ“ä½œ<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
<div id="comments"><div id="valine" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://valine.js.org/">Valine</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
    <div class="footer-container">
        <div class="footer-line">
            <span id="run-time"></span>
        </div><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer"
                title="Hugo 0.115.1">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank"
                rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw"
                    aria-hidden="true"></i> LoveIt</a>
        </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2023</span><span class="author" itemprop="copyrightHolder">&nbsp;<a
                    href="/" target="_blank">Chuyu</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
    </div>
</footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/valine/valine.min.css"><link rel="stylesheet" href="/lib/lightgallery/css/lightgallery-bundle.min.css"><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script type="text/javascript" src="/lib/valine/Valine.min.js"></script><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lightgallery.min.js"></script><script type="text/javascript" src="/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js"></script><script type="text/javascript" src="/lib/lightgallery/plugins/zoom/lg-zoom.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/cookieconsent/cookieconsent.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{"valine":{"appId":"agUqGfsZRxSQL7fq0tYPH6Zp-MdYXbMMI","appKey":"2e9VDVO0nPzBiJqpzPN6kVPC","avatar":"mp","el":"#valine","emojiCDN":"https://cdn.jsdelivr.net/npm/emoji-datasource-google@14.0.0/img/google/64/","emojiMaps":{"100":"1f4af.png","alien":"1f47d.png","anger":"1f4a2.png","angry":"1f620.png","anguished":"1f627.png","astonished":"1f632.png","black_heart":"1f5a4.png","blue_heart":"1f499.png","blush":"1f60a.png","bomb":"1f4a3.png","boom":"1f4a5.png","broken_heart":"1f494.png","brown_heart":"1f90e.png","clown_face":"1f921.png","cold_face":"1f976.png","cold_sweat":"1f630.png","confounded":"1f616.png","confused":"1f615.png","cry":"1f622.png","crying_cat_face":"1f63f.png","cupid":"1f498.png","dash":"1f4a8.png","disappointed":"1f61e.png","disappointed_relieved":"1f625.png","dizzy":"1f4ab.png","dizzy_face":"1f635.png","drooling_face":"1f924.png","exploding_head":"1f92f.png","expressionless":"1f611.png","face_vomiting":"1f92e.png","face_with_cowboy_hat":"1f920.png","face_with_hand_over_mouth":"1f92d.png","face_with_head_bandage":"1f915.png","face_with_monocle":"1f9d0.png","face_with_raised_eyebrow":"1f928.png","face_with_rolling_eyes":"1f644.png","face_with_symbols_on_mouth":"1f92c.png","face_with_thermometer":"1f912.png","fearful":"1f628.png","flushed":"1f633.png","frowning":"1f626.png","ghost":"1f47b.png","gift_heart":"1f49d.png","green_heart":"1f49a.png","grimacing":"1f62c.png","grin":"1f601.png","grinning":"1f600.png","hankey":"1f4a9.png","hear_no_evil":"1f649.png","heart":"2764-fe0f.png","heart_decoration":"1f49f.png","heart_eyes":"1f60d.png","heart_eyes_cat":"1f63b.png","heartbeat":"1f493.png","heartpulse":"1f497.png","heavy_heart_exclamation_mark_ornament":"2763-fe0f.png","hole":"1f573-fe0f.png","hot_face":"1f975.png","hugging_face":"1f917.png","hushed":"1f62f.png","imp":"1f47f.png","innocent":"1f607.png","japanese_goblin":"1f47a.png","japanese_ogre":"1f479.png","joy":"1f602.png","joy_cat":"1f639.png","kiss":"1f48b.png","kissing":"1f617.png","kissing_cat":"1f63d.png","kissing_closed_eyes":"1f61a.png","kissing_heart":"1f618.png","kissing_smiling_eyes":"1f619.png","laughing":"1f606.png","left_speech_bubble":"1f5e8-fe0f.png","love_letter":"1f48c.png","lying_face":"1f925.png","mask":"1f637.png","money_mouth_face":"1f911.png","nauseated_face":"1f922.png","nerd_face":"1f913.png","neutral_face":"1f610.png","no_mouth":"1f636.png","open_mouth":"1f62e.png","orange_heart":"1f9e1.png","partying_face":"1f973.png","pensive":"1f614.png","persevere":"1f623.png","pleading_face":"1f97a.png","pouting_cat":"1f63e.png","purple_heart":"1f49c.png","rage":"1f621.png","relaxed":"263a-fe0f.png","relieved":"1f60c.png","revolving_hearts":"1f49e.png","right_anger_bubble":"1f5ef-fe0f.png","robot_face":"1f916.png","rolling_on_the_floor_laughing":"1f923.png","scream":"1f631.png","scream_cat":"1f640.png","see_no_evil":"1f648.png","shushing_face":"1f92b.png","skull":"1f480.png","skull_and_crossbones":"2620-fe0f.png","sleeping":"1f634.png","sleepy":"1f62a.png","slightly_frowning_face":"1f641.png","slightly_smiling_face":"1f642.png","smile":"1f604.png","smile_cat":"1f638.png","smiley":"1f603.png","smiley_cat":"1f63a.png","smiling_face_with_3_hearts":"1f970.png","smiling_imp":"1f608.png","smirk":"1f60f.png","smirk_cat":"1f63c.png","sneezing_face":"1f927.png","sob":"1f62d.png","space_invader":"1f47e.png","sparkling_heart":"1f496.png","speak_no_evil":"1f64a.png","speech_balloon":"1f4ac.png","star-struck":"1f929.png","stuck_out_tongue":"1f61b.png","stuck_out_tongue_closed_eyes":"1f61d.png","stuck_out_tongue_winking_eye":"1f61c.png","sunglasses":"1f60e.png","sweat":"1f613.png","sweat_drops":"1f4a6.png","sweat_smile":"1f605.png","thinking_face":"1f914.png","thought_balloon":"1f4ad.png","tired_face":"1f62b.png","triumph":"1f624.png","two_hearts":"1f495.png","unamused":"1f612.png","upside_down_face":"1f643.png","weary":"1f629.png","white_frowning_face":"2639-fe0f.png","white_heart":"1f90d.png","wink":"1f609.png","woozy_face":"1f974.png","worried":"1f61f.png","yawning_face":"1f971.png","yellow_heart":"1f49b.png","yum":"1f60b.png","zany_face":"1f92a.png","zipper_mouth_face":"1f910.png","zzz":"1f4a4.png"},"enableQQ":true,"highlight":true,"lang":"zh-CN","meta":["nick","mail","link"],"pageSize":10,"placeholder":"å¼€å§‹å‹å¥½çš„äº¤æµå§~","recordIP":true,"serverURLs":"https://mukjinfv.api.lncldglobal.com","visitor":true}},"cookieconsent":{"content":{"dismiss":"Got it!","link":"Learn more","message":"This website uses Cookies to improve your experience."},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"lightgallery":true,"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"lunr"}};</script><script type="text/javascript" src="/js/theme.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/jquery@2.1.3/dist/jquery.min.js"></script><script type="text/javascript" src="/js/custom.js"></script></body>
</html>
